<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="keywords" content="Hexo Theme Redefine"><meta name="author" content="Fre5h1nd"><script>!function(){const e="dark";function t(t){const o=t===e,c=document.documentElement;c.setAttribute("data-theme",t),c.classList.add(t),c.classList.remove(o?"light":e),c.style.colorScheme=t}const o=function(){try{const t=localStorage.getItem("REDEFINE-THEME-STATUS");if(t){const{isDark:o}=JSON.parse(t);return o?e:"light"}}catch(e){}return matchMedia("(prefers-color-scheme: dark)").matches?e:"light"}();t(o),matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:o})=>{localStorage.getItem("REDEFINE-THEME-STATUS")||t(o?e:"light")}),"loading"!==document.readyState?document.body.classList.add(o+"-mode"):document.addEventListener("DOMContentLoaded",()=>{document.body.classList.add(o+"-mode"),document.body.classList.remove((o===e?"light":e)+"-mode")})}()</script><style>:root[data-theme=dark]{--background-color:#202124;--background-color-transparent:rgba(32, 33, 36, 0.6);--second-background-color:#2d2e32;--third-background-color:#34353a;--third-background-color-transparent:rgba(32, 33, 36, 0.6);--primary-color:#0066CC;--first-text-color:#ffffff;--second-text-color:#eeeeee;--third-text-color:#bebec6;--fourth-text-color:#999999;--default-text-color:#bebec6;--invert-text-color:#373D3F;--border-color:rgba(255, 255, 255, 0.08);--selection-color:#0066CC;--shadow-color-1:rgba(255, 255, 255, 0.08);--shadow-color-2:rgba(255, 255, 255, 0.05)}:root[data-theme=light]{--background-color:#fff;--background-color-transparent:rgba(255, 255, 255, 0.6);--second-background-color:#f8f8f8;--third-background-color:#f2f2f2;--third-background-color-transparent:rgba(241, 241, 241, 0.6);--primary-color:#0066CC;--first-text-color:#16171a;--second-text-color:#2f3037;--third-text-color:#5e5e5e;--fourth-text-color:#eeeeee;--default-text-color:#373D3F;--invert-text-color:#bebec6;--border-color:rgba(0, 0, 0, 0.08);--selection-color:#0066CC;--shadow-color-1:rgba(0, 0, 0, 0.08);--shadow-color-2:rgba(0, 0, 0, 0.05)}body{background-color:var(--background-color);color:var(--default-text-color)}:root[data-theme=dark] body{background-color:var(--background-color);color:var(--default-text-color)}</style><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://registry.npmmirror.com" crossorigin><link rel="canonical" href="https://freshwlnd.github.io/2025/08/07/k8s/k8s-scheduler-performance-volcano-metrics/"><meta name="robots" content="index,follow"><meta name="googlebot" content="index,follow"><meta name="revisit-after" content="1 days"><meta name="description" content="å»¶ç»­ä¸Šä¸€ç¯‡æµ‹è¯•æµç¨‹æ‹†è§£ï¼Œæœ¬æ–‡èšç„¦ kube-apiserver å®¡è®¡æ—¥å¿—å¦‚ä½•è¢«å¯¼å‡ºã€è½¬åŒ–ä¸º Prometheus æŒ‡æ ‡å¹¶åœ¨ Grafana é¢æ¿ä¸Šå‘ˆç°ã€‚"><meta property="og:type" content="article"><meta property="og:title" content="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–"><meta property="og:url" content="https://freshwlnd.github.io/2025/08/07/k8s/k8s-scheduler-performance-volcano-metrics/index.html"><meta property="og:site_name" content="Fre5h1nd&#39;s Blog"><meta property="og:description" content="å»¶ç»­ä¸Šä¸€ç¯‡æµ‹è¯•æµç¨‹æ‹†è§£ï¼Œæœ¬æ–‡èšç„¦ kube-apiserver å®¡è®¡æ—¥å¿—å¦‚ä½•è¢«å¯¼å‡ºã€è½¬åŒ–ä¸º Prometheus æŒ‡æ ‡å¹¶åœ¨ Grafana é¢æ¿ä¸Šå‘ˆç°ã€‚"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2025-08-07T14:59:25.000Z"><meta property="article:modified_time" content="2025-09-18T07:27:36.966Z"><meta property="article:author" content="Fre5h1nd"><meta property="article:tag" content="K8s"><meta property="article:tag" content="æ€§èƒ½æµ‹è¯•"><meta property="article:tag" content="ç›‘æ§"><meta property="article:tag" content="Volcano"><meta name="twitter:card" content="summary"><script src="https://www.googletagmanager.com/gtag/js?id=G-GGER3VDLBF"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GGER3VDLBF")</script><link rel="icon" type="image/png" href="/images/favicon.png" sizes="192x192"><link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.png"><meta name="theme-color" content="#A31F34"><link rel="shortcut icon" href="/images/favicon.png"><title>ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ– | Fre5h1nd&#39;s Blog</title><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fonts/Chillax/chillax.css"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/css/build/tailwind.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fonts/GeistMono/geist-mono.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fonts/Geist/geist.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/anime.min.js"></script><script id="hexo-configurations">window.config={hostname:"freshwlnd.github.io",root:"/",language:"zh-CN",path:"search.xml"},window.theme={articles:{style:{font_size:"16px",line_height:1.5,image_border_radius:"14px",image_alignment:"center",image_caption:!0,link_icon:!0,delete_mask:!1,title_alignment:"left",headings_top_spacing:{h1:"3.2rem",h2:"2.4rem",h3:"1.9rem",h4:"1.6rem",h5:"1.4rem",h6:"1.3rem"}},word_count:{enable:!0,count:!0,min2read:!0},author_label:{enable:!0,auto:!0,list:[]},code_block:{copy:!0,style:"mac",highlight_theme:{light:"github",dark:"vs2015"},font:{enable:!1,family:null,url:null}},toc:{enable:!0,max_depth:3,number:!0,expand:!0,init_open:!0},copyright:{enable:!0,default:"cc_by_nc_sa"},lazyload:!0,pangu_js:!1,recommendation:{enable:!0,title:"æ¨èé˜…è¯»",limit:3,mobile_limit:2,placeholder:"/images/wallhaven-wqery6-light.webp",skip_dirs:[]}},colors:{primary:"#A31F34",secondary:null,default_mode:"light"},global:{fonts:{chinese:{enable:!1,family:null,url:null},english:{enable:!1,family:null,url:null},title:{enable:!1,family:null,url:null}},content_max_width:"1000px",sidebar_width:"210px",hover:{shadow:!0,scale:!0},scroll_progress:{bar:!0,percentage:!0},website_counter:{url:"https://cn.vercount.one/js",enable:!0,site_pv:!0,site_uv:!0,post_pv:!0},single_page:!0,preloader:!0,side_tools:{gear_rotation:!0,auto_expand:!1},open_graph:!0,google_analytics:{enable:!0,id:"G-GGER3VDLBF"},pjax:!0},home_banner:{enable:!0,style:"fixed",image:{light:"/images/wallhaven-wqery6-light.webp",dark:"/images/wallhaven-wqery6-dark.webp"},title:"Fre5h1nd's Blog",subtitle:{text:["Loading..."],hitokoto:{enable:!0,show_author:!1,api:"https://v1.hitokoto.cn?c=d&c=i&c=k"},typing_speed:100,backing_speed:80,starting_delay:500,backing_delay:1500,loop:!0,smart_backspace:!0},text_color:{light:"#fff",dark:"#d1d1b6"},text_style:{title_size:"2.8rem",subtitle_size:"1.5rem",line_height:1.2},custom_font:{enable:!1,family:null,url:null},social_links:{enable:!0,style:"default",links:{github:"https://github.com/Freshwlnd",instagram:null,zhihu:null,twitter:null,email:"xuyh@tongji.edu.cn"},qrs:{weixin:null}}},plugins:{feed:{enable:!0},aplayer:{enable:!0,type:"fixed",audios:[{name:"æ’å™äººç”Ÿï¼ˆMontageï¼‰",artist:"Y.Z.H / ææ™¨æ›¦Chrisulous",url:"http://music.163.com/song/media/outer/url?id=2071177415.mp3",cover:"https://p2.music.126.net/KrsOhbsXgsVtFi0C2w320g==/109951168823736894.jpg?imageView&thumbnail=360y360&quality=75&tostatic=0",lrc:null}]},mermaid:{enable:!0,version:"11.4.1"}},version:"2.8.5",navbar:{auto_hide:!1,color:{left:"#f78736",right:"#367df7",transparency:35},width:{home:"1200px",pages:"1000px"},links:{Home:{path:"/",icon:"fa-regular fa-house"},Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Categories:{path:"/categories",icon:"fa-regular fa-folder"},shuoshuo:{path:"/essays",icon:"fa-regular fa-seedling"},images:{path:"/masonry",icon:"fa-regular fa-image"},About:{icon:"fa-regular fa-user",submenus:{Me:"/about",Github:"https://github.com/Freshwlnd","Google Scholar":"https://scholar.google.com/citations?user=01vyCxEAAAAJ&hl=zh-CN",Friends:"/links"}}},search:{enable:!0,preload:!0}},page_templates:{friends_column:2,tags_style:"blur"},home:{sidebar:{enable:!0,position:"left",first_item:"menu",announcement:"æ¬¢è¿ç•™ä¸‹è¶³è¿¹",show_on_mobile:!0,links:{Archives:{path:"/archives",icon:"fa-regular fa-archive"},Tags:{path:"/tags",icon:"fa-regular fa-tags"},Categories:{path:"/categories",icon:"fa-regular fa-folder"}}},article_date_format:"auto",excerpt_length:200,categories:{enable:!0,limit:3},tags:{enable:!0,limit:3}},footerStart:"2018/07/04 21:00:00"},window.lang_ago={second:"%s ç§’å‰",minute:"%s åˆ†é’Ÿå‰",hour:"%s å°æ—¶å‰",day:"%s å¤©å‰",week:"%s å‘¨å‰",month:"%s ä¸ªæœˆå‰",year:"%s å¹´å‰"},window.data={masonry:!0}</script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fontawesome/fontawesome.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fontawesome/brands.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fontawesome/solid.min.css"><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/fontawesome/regular.min.css"><meta name="generator" content="Hexo 5.4.2"><link rel="alternate" href="/atom.xml" title="Fre5h1nd's Blog" type="application/atom+xml">
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head><body><div class="progress-bar-container"><span class="scroll-progress-bar"></span> <span class="pjax-progress-bar"></span></div><style>:root{--preloader-background-color:#fff;--preloader-text-color:#000}@media (prefers-color-scheme:dark){:root{--preloader-background-color:#202124;--preloader-text-color:#fff}}@media (prefers-color-scheme:light){:root{--preloader-background-color:#fff;--preloader-text-color:#000}}@media (max-width:600px){.ml13{font-size:2.6rem!important}}.preloader{display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center;position:fixed;padding:12px;top:0;right:0;bottom:0;left:0;width:100vw;height:100vh;background-color:var(--preloader-background-color);z-index:1100;transition:opacity .2s ease-in-out}.ml13{font-size:3.2rem;color:var(--preloader-text-color);letter-spacing:-1px;font-weight:500;font-family:Chillax-Variable,sans-serif;text-align:center}.ml13 .word{display:inline-flex;flex-wrap:wrap;white-space:nowrap}.ml13 .letter{display:inline-block;line-height:1em}</style><div class="preloader"><h2 class="ml13">Fre5h1nd&#39;s Blog</h2><script>var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({ loop: true })
            .add({
                targets: '.ml13 .letter',
                translateY: [20, 0],
                translateZ: 0,
                opacity: [0, 1],
                filter: ['blur(5px)', 'blur(0px)'],
                easing: "easeOutExpo",
                duration: 1200,
                delay: (el, i) => 300 + 20 * i,
            })
            .add({
                targets: '.ml13 .letter',
                translateY: [0, -20],
                opacity: [1, 0],
                filter: ['blur(0px)', 'blur(5px)'],
                easing: "easeInExpo",
                duration: 1000,
                delay: (el, i) => 15 * i,
                complete: function() {
                    hidePreloader();
                }
            }, '-=700');


        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }</script></div><main class="page-container" id="swup"><div class="main-content-container flex flex-col justify-between min-h-dvh"><div class="main-content-header"><header class="navbar-container px-6 md:px-12"><div class="navbar-content transition-navbar"><div class="left"><a class="logo-title" href="/">Fre5h1nd&#39;s Blog</a></div><div class="right"><div class="desktop"><ul class="navbar-list"><li class="navbar-item"><a href="/"><i class="fa-regular fa-house fa-fw"></i> é¦–é¡µ</a></li><li class="navbar-item"><a href="/archives"><i class="fa-regular fa-archive fa-fw"></i> å½’æ¡£</a></li><li class="navbar-item"><a href="/tags"><i class="fa-regular fa-tags fa-fw"></i> æ ‡ç­¾</a></li><li class="navbar-item"><a href="/categories"><i class="fa-regular fa-folder fa-fw"></i> åˆ†ç±»</a></li><li class="navbar-item"><a href="/essays"><i class="fa-regular fa-seedling fa-fw"></i> çµæ„Ÿ</a></li><li class="navbar-item"><a href="/masonry"><i class="fa-regular fa-image fa-fw"></i> å›¾åº“</a></li><li class="navbar-item"><a class="has-dropdown" href="#" onclick="&#34;return" false;&#34;><i class="fa-regular fa-user fa-fw"></i> å…³äº <i class="fa-solid fa-chevron-down fa-fw"></i></a><ul class="sub-menu"><li><a href="/about">ME</a></li><li><a target="_blank" rel="noopener" href="https://github.com/Freshwlnd">GITHUB</a></li><li><a target="_blank" rel="noopener" href="https://scholar.google.com/citations?user=01vyCxEAAAAJ&hl=zh-CN">GOOGLE SCHOLAR</a></li><li><a href="/links">å‹æƒ…é“¾æ¥</a></li></ul></li><li class="navbar-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i></div><div class="icon-item navbar-bar"><div class="navbar-bar-middle"></div></div></div></div></div><div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between"><ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start"><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/"><span>é¦–é¡µ </span><i class="fa-regular fa-house fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/archives"><span>å½’æ¡£ </span><i class="fa-regular fa-archive fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/tags"><span>æ ‡ç­¾ </span><i class="fa-regular fa-tags fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/categories"><span>åˆ†ç±» </span><i class="fa-regular fa-folder fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/essays"><span>çµæ„Ÿ </span><i class="fa-regular fa-seedling fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full"><a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" href="/masonry"><span>å›¾åº“ </span><i class="fa-regular fa-image fa-sm fa-fw"></i></a></li><li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full"><div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full" navbar-data-toggle="submenu-About"><span>å…³äº </span><i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i></div><div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About"><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" href="/about">ME</a></div><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" target="_blank" rel="noopener" href="https://github.com/Freshwlnd">GITHUB</a></div><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" target="_blank" rel="noopener" href="https://scholar.google.com/citations?user=01vyCxEAAAAJ&hl=zh-CN">GOOGLE SCHOLAR</a></div><div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl"><a class="text-third-text-color text-xl" href="/links">å‹æƒ…é“¾æ¥</a></div></div></li></ul><div class="statistics flex justify-around my-2.5"><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">199</div><div class="label text-third-text-color text-sm">æ ‡ç­¾</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">35</div><div class="label text-third-text-color text-sm">åˆ†ç±»</div></a><a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives"><div class="number text-2xl sm:text-xl text-second-text-color font-semibold">162</div><div class="label text-third-text-color text-sm">æ–‡ç« </div></a></div></div><div class="window-mask"></div></header></div><div class="main-content-body transition-fade-up"><div class="main-content"><div class="post-page-container flex relative justify-between box-border w-full h-full"><div class="article-content-container"><div class="article-title relative w-full"><img src="https://www.splunk.com/content/dam/splunk-blogs/images/en_uk/2025/2/kubecon-landscape.jpg" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75"><div class="w-full flex items-center absolute bottom-0 justify-start"><h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-semibold backdrop-blur-lg rounded-xl border border-border-color">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–</h1></div></div><div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8"><div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]"><img src="/images/MessAround.jpeg"></div><div class="info flex flex-col justify-between"><div class="author flex items-center"><span class="name text-default-text-color text-lg font-semibold">Fre5h1nd</span> <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv6</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fa-regular fa-pen-fancy"></i>&nbsp; <span class="desktop">2025-08-07 22:59:25</span> <span class="mobile">2025-08-07 22:59:25</span> <span class="hover-info">åˆ›å»º</span> </span><span class="article-date article-meta-item"><i class="fa-regular fa-wrench"></i>&nbsp; <span class="desktop">2025-09-18 15:27:36</span> <span class="mobile">2025-09-18 15:27:36</span> <span class="hover-info">æ›´æ–°</span> </span><span class="article-categories article-meta-item"><i class="fa-regular fa-folders"></i>&nbsp;<ul><li><a href="/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯</a>&nbsp;</li><li>></li><li><a href="/categories/%E6%8A%80%E6%9C%AF/%E4%BA%91%E8%AE%A1%E7%AE%97/">äº‘è®¡ç®—</a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fa-regular fa-tags"></i>&nbsp;<ul><li><a href="/tags/K8s/">K8s</a>&nbsp;</li><li>| <a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">æ€§èƒ½æµ‹è¯•</a>&nbsp;</li><li>| <a href="/tags/%E7%9B%91%E6%8E%A7/">ç›‘æ§</a>&nbsp;</li><li>| <a href="/tags/Volcano/">Volcano</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fa-regular fa-typewriter"></i>&nbsp;<span>5k å­—</span> </span><span class="article-min2read article-meta-item"><i class="fa-regular fa-clock"></i>&nbsp;<span>21 åˆ†é’Ÿ</span> </span><span class="article-pv article-meta-item"><i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8"><blockquote><p>æœ¬ç³»åˆ—ã€Šäº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano ç›‘æ§ä¸æ€§èƒ½æµ‹è¯•ã€‹è®¡åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ç¯‡ï¼Œç‚¹å‡»æŸ¥çœ‹å…¶å®ƒå†…å®¹ã€‚</p><ol><li><a href="/2025/06/24/k8s/k8s-scheduler-performance-test/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ä¸ç›‘æ§å·¥å…· kube-scheduling-perf">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ä¸ç›‘æ§å·¥å…· kube-scheduling-perf</a></li><li><a href="/2025/07/01/k8s/k8s-scheduler-performance-test-debug/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ä¸ç›‘æ§å·¥å…· kube-scheduling-perf å®æ“æ³¨æ„äº‹é¡¹è¯´æ˜">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ä¸ç›‘æ§å·¥å…· kube-scheduling-perf å®æ“æ³¨æ„äº‹é¡¹è¯´æ˜</a></li><li><a href="/2025/06/26/k8s/k8s-scheduler-performance-video/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ç›‘æ§ç»“æœ">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šè°ƒåº¦å™¨æµ‹è¯•ç›‘æ§ç»“æœ</a></li><li><a href="/2025/07/23/k8s/k8s-scheduler-performance-test-local/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šæœ¬åœ°ç¯å¢ƒæµ‹è¯•ç»“æœä¸è§†é¢‘å¯¹æ¯”åˆ†æ">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šæœ¬åœ°ç¯å¢ƒæµ‹è¯•ç»“æœä¸è§†é¢‘å¯¹æ¯”åˆ†æ</a></li><li><a href="/2025/07/27/k8s/k8s-scheduler-performance-volcano-process/" title="ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæµ‹è¯•æµç¨‹æ‹†è§£ç¯‡">ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæµ‹è¯•æµç¨‹æ‹†è§£ç¯‡</a></li><li><a href="/2025/08/07/k8s/k8s-scheduler-performance-volcano-metrics/" title="ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–ç¯‡">ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–ç¯‡</a></li><li><a href="/2025/09/09/k8s/k8s-scheduler-performance-go-analysis/" title="ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ">ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ</a></li><li><a href="/2025/08/08/k8s/k8s-scheduler-performance-volcano-custom/" title="ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šè‡ªå®šä¹‰é•œåƒæ€§èƒ½å›å½’æµ‹è¯•">ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šè‡ªå®šä¹‰é•œåƒæ€§èƒ½å›å½’æµ‹è¯•</a></li><li><a href="/2025/08/10/k8s/k8s-scheduler-performance-volcano-analysis/" title="ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜">ç›‘æ§ä¸æµ‹è¯•ç¯å¢ƒè§£æï¼šæ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜</a></li><li><a href="/2025/08/17/k8s/k8s-scheduler-performance-volcano-enqueue/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoè°ƒåº¦å™¨enqueueåŠŸèƒ½ç¦ç”¨ä¸æ€§èƒ½æµ‹è¯•">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoè°ƒåº¦å™¨enqueueåŠŸèƒ½ç¦ç”¨ä¸æ€§èƒ½æµ‹è¯•</a></li><li><a href="/2025/08/18/k8s/k8s-scheduler-performance-volcano-webhook-debug/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano Podåˆ›å»ºæ•°é‡ä¸è¶³é—®é¢˜æ’æŸ¥ä¸Webhookè¶…æ—¶ä¿®å¤">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano Podåˆ›å»ºæ•°é‡ä¸è¶³é—®é¢˜æ’æŸ¥ä¸Webhookè¶…æ—¶ä¿®å¤</a></li><li><a href="/2025/08/20/k8s/k8s-scheduler-performance-volcano-version/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoç‰ˆæœ¬ä¿®æ”¹ä¸æ€§èƒ½æµ‹è¯•ä¼˜åŒ–">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoç‰ˆæœ¬ä¿®æ”¹ä¸æ€§èƒ½æµ‹è¯•ä¼˜åŒ–</a></li><li><a href="/2025/08/22/k8s/k8s-scheduler-performance-volcano-webhook-disable/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano Webhookç¦ç”¨ä¸æ€§èƒ½ç“¶é¢ˆåˆ†æ">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano Webhookç¦ç”¨ä¸æ€§èƒ½ç“¶é¢ˆåˆ†æ</a></li><li><a href="/2025/08/24/k8s/k8s-scheduler-performance-volcano-hypothesis-verification/" title="äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoæ€§èƒ½ç“¶é¢ˆçŒœæƒ³éªŒè¯ä¸å®éªŒæ€»ç»“">äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcanoæ€§èƒ½ç“¶é¢ˆçŒœæƒ³éªŒè¯ä¸å®éªŒæ€»ç»“</a></li></ol></blockquote><p>ä¸Šä¸€ç¯‡æˆ‘ä»¬ä» <strong>Makefile â†’ Kind â†’ æµ‹è¯•ä»£ç </strong> ä¸²èµ·äº†ä¸€æ¬¡æœ€å°æ€§èƒ½æµ‹è¯•çš„å…¨é“¾è·¯ã€‚æœ¬ç¯‡å°†å›ç­”å¦ä¸€ä¸ªå¸¸è§é—®é¢˜ï¼š</p><blockquote><p><em>ã€Œ<code>TestBatchJob</code> è·‘å®Œåï¼ŒGrafana é¢æ¿ä¸Šçš„ CREATED / SCHEDULED / RUNNING æ›²çº¿æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿã€</em></p></blockquote><p>ä¸‹å›¾ç»™å‡ºäº†æ ¸å¿ƒç»„ä»¶ä¸æ•°æ®æµï¼Œé˜…è¯»å®Œæœ¬æ–‡ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®ä½ å¿«é€Ÿå®ç°ï¼š</p><ol><li>ç†è§£ å®¡è®¡æ—¥å¿— â†’ Exporter â†’ Prometheus+Grafana â†’ æˆªå›¾å½’æ¡£ çš„ç«¯åˆ°ç«¯é“¾è·¯ï¼›</li><li>è‡ªå®šä¹‰å®¡è®¡ç­–ç•¥ &amp; é¢æ¿æŸ¥è¯¢ &amp; æˆªå›¾å½’æ¡£ã€‚</li></ol><pre class="mermaid">graph LR;
  subgraph Control-Plane å®¡è®¡æ—¥å¿—
    APIServer["Kube-APIServer(å¼€å¯å®¡è®¡)"] --&gt;|/var/log/kubernetes/kube-apiserver-audit.log| NodeDisk[(control-plane èŠ‚ç‚¹ç£ç›˜)]
  end

  NodeDisk --&gt; Exporter["Audit-Exporter(Deployment)"]
  Exporter --&gt;|/metrics| Prometheus((Prometheus))
  Prometheus --&gt; Grafana[(Grafana Dashboard)]
  Grafana --&gt; Script[save-result-images.sh]</pre><hr><h1 id="1ï¸âƒ£-å®¡è®¡æ—¥å¿—ï¼šaudit-policy-yaml-å†³å®šè®°å½•ä»€ä¹ˆ"><a href="#1ï¸âƒ£-å®¡è®¡æ—¥å¿—ï¼šaudit-policy-yaml-å†³å®šè®°å½•ä»€ä¹ˆ" class="headerlink" title="1ï¸âƒ£ å®¡è®¡æ—¥å¿—ï¼šaudit-policy.yaml å†³å®šè®°å½•ä»€ä¹ˆ"></a>1ï¸âƒ£ å®¡è®¡æ—¥å¿—ï¼šaudit-policy.yaml å†³å®š<strong>è®°å½•ä»€ä¹ˆ</strong></h1><p>å¯¹åº”å‰æ–‡æµç¨‹å›¾ä¸­çš„ <code>Control-Plane å®¡è®¡æ—¥å¿—</code> éƒ¨åˆ†ï¼Œåœ¨ Kubernetes ä¸­ï¼Œæ¯ä¸ªè¯·æ±‚åœ¨ä¸åŒæ‰§è¡Œé˜¶æ®µéƒ½ä¼šç”Ÿæˆå®¡è®¡äº‹ä»¶ï¼›è¿™äº›å®¡è®¡äº‹ä»¶ä¼šæ ¹æ®ç‰¹å®šç­–ç•¥è¢«é¢„å¤„ç†å¹¶å†™å…¥åç«¯ã€‚<a href="#refer-anchor-1"><sup>[3]</sup></a></p><p>åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼ŒKubernetes å®¡è®¡å­ç³»ç»Ÿéœ€è¦ä¸€ä»½ <em>Policy</em> æ–‡ä»¶æ¥å£°æ˜è§„åˆ™ï¼ˆæŒ‡æ˜éœ€è®°å½•çš„äº‹ä»¶èŒƒå›´ï¼‰ã€‚è€Œæœ¬é¡¹ç›®æ ¹ç›®å½•çš„ <code>audit-policy.yaml</code> ä¸­å°±å£°æ˜äº†ä¸€å¥—è§„åˆ™ï¼Œé‡ç‚¹æ‹¦æˆªäº†è¡¡é‡è°ƒåº¦å™¨ååé‡çš„å…³é”®å¯¹è±¡ <strong>Pod / Job çš„ CRUD</strong>ï¼š</p><div class="code-container" data-rel="Yaml"><figure class="iseeu highlight yaml"><figcaption><span>audit-policy.yaml</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">audit.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Policy</span></span><br><span class="line"><span class="attr">omitManagedFields:</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">omitStages:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">RequestReceived</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">ResponseStarted</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">level:</span> <span class="string">RequestResponse</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">group:</span> <span class="string">""</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pods</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pods/binding</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">pods/status</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">group:</span> <span class="string">batch</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">jobs</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">jobs/status</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">group:</span> <span class="string">batch.volcano.sh</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">jobs</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">jobs/status</span></span><br><span class="line">  <span class="attr">verbs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">create</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">patch</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">update</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">delete</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">level:</span> <span class="string">Metadata</span></span><br></pre></td></tr></table></figure></div><ul><li><code>omitStages</code> æŒ‡æ˜æ¯ä¸ªè¯·æ±‚å¯æ— é¡»è®°å½•ç›¸å…³çš„é˜¶æ®µï¼ˆstageï¼‰ã€‚Kubernetes ä¸­å·²å®šä¹‰çš„é˜¶æ®µæœ‰ï¼š<ul><li><code>RequestReceived</code> - æ­¤é˜¶æ®µå¯¹åº”å®¡è®¡å¤„ç†å™¨æ¥æ”¶åˆ°è¯·æ±‚åï¼Œ å¹¶ä¸”åœ¨å§”æ‰˜ç»™å…¶ä½™å¤„ç†å™¨ä¹‹å‰ç”Ÿæˆçš„äº‹ä»¶ã€‚</li><li><code>ResponseStarted</code> - åœ¨å“åº”æ¶ˆæ¯çš„å¤´éƒ¨å‘é€åï¼Œå“åº”æ¶ˆæ¯ä½“å‘é€å‰ç”Ÿæˆçš„äº‹ä»¶ã€‚ åªæœ‰é•¿æ—¶é—´è¿è¡Œçš„è¯·æ±‚ï¼ˆä¾‹å¦‚ watchï¼‰æ‰ä¼šç”Ÿæˆè¿™ä¸ªé˜¶æ®µã€‚</li><li><code>ResponseComplete</code> - å½“å“åº”æ¶ˆæ¯ä½“å®Œæˆå¹¶ä¸”æ²¡æœ‰æ›´å¤šæ•°æ®éœ€è¦ä¼ è¾“çš„æ—¶å€™ã€‚</li><li><code>Panic</code> - å½“ panic å‘ç”Ÿæ—¶ç”Ÿæˆã€‚</li></ul></li><li><code>level: RequestResponse</code> æ—¢ä¿ç•™è¯·æ±‚å¤´ï¼Œä¹ŸåŒ…å«å“åº”ä½“ï¼Œæ–¹ä¾¿åç»­è§£æå‡º <strong>Result åŠè€—æ—¶</strong>ã€‚<ul><li><code>verbs</code> æŒ‡æ˜æ­¤è§„åˆ™æ‰€é€‚ç”¨çš„æ“ä½œï¼ˆverbï¼‰åˆ—è¡¨ã€‚å°† CREATE / PATCH / UPDATE / DELETE å››ç±»æ“ä½œä¸€æ¬¡æ€§è¦†ç›–ï¼›</li><li><code>resources</code> æŒ‡æ˜æ­¤è§„åˆ™æ‰€é€‚ç”¨çš„èµ„æºç±»åˆ«åˆ—è¡¨ï¼ŒåŒ…å« <code>batch</code>ã€<code>batch.volcano.sh/jobs</code> ç­‰ CRDï¼Œå…¼é¡¾ä¸åŒè°ƒåº¦å™¨å¯¹è±¡ã€‚å­—æ®µ <code>group</code> ç»™å‡ºåŒ…å«èµ„æºçš„ API ç»„çš„åç§°ï¼Œç©ºå­—ç¬¦ä¸²ä»£è¡¨ core API ç»„ã€‚</li></ul></li><li><code>level: Metadata</code> åˆ™ä»…è®°å½•è¯·æ±‚çš„å…ƒæ•°æ®ï¼ˆè¯·æ±‚çš„ç”¨æˆ·ã€æ—¶é—´æˆ³ã€èµ„æºã€åŠ¨è¯ç­‰ç­‰ï¼‰ï¼Œ ä½†æ˜¯ä¸è®°å½•è¯·æ±‚æˆ–è€…å“åº”çš„æ¶ˆæ¯ä½“ã€‚<ul><li><code>resources</code> ä¸ºç©ºåˆ—è¡¨æ„å‘³ç€é€‚ç”¨äº API ç»„ä¸­çš„æ‰€æœ‰èµ„æºç±»åˆ«ã€‚</li></ul></li></ul><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ <code>--audit-policy-file</code> æ ‡å¿—å°†åŒ…å«ç­–ç•¥çš„æ–‡ä»¶ä¼ é€’ç»™ <code>kube-apiserver</code>ã€‚</p><h2 id="â–¶ï¸-FAQï¼šç­–ç•¥ç»†èŠ‚å¸¸è§ç–‘é—®"><a href="#â–¶ï¸-FAQï¼šç­–ç•¥ç»†èŠ‚å¸¸è§ç–‘é—®" class="headerlink" title="â–¶ï¸ FAQï¼šç­–ç•¥ç»†èŠ‚å¸¸è§ç–‘é—®"></a>â–¶ï¸ FAQï¼šç­–ç•¥ç»†èŠ‚å¸¸è§ç–‘é—®</h2><blockquote><p>ğŸ’¡ ä»¥ä¸‹å†…å®¹ä¸“é—¨å›åº”åœ¨é˜…è¯»æºç æ—¶æœ€å¸¸è§çš„ 3 ä¸ªç–‘æƒ‘ã€‚</p></blockquote><p><strong>â‘  <code>level: Metadata</code> ä¸ <code>level: RequestResponse</code> æœ‰ä½•åŒºåˆ«ï¼Ÿä¸ºä½•éƒ½è¦ä¿ç•™ï¼Ÿ</strong></p><ul><li>ä½œç”¨åŸŸä¸åŒï¼š<ul><li><code>RequestResponse</code> è§„åˆ™<strong>åª</strong>åŒ¹é…æˆ‘ä»¬å…³å¿ƒçš„è°ƒåº¦ç›¸å…³èµ„æºï¼ˆ<code>pods</code> / <code>jobs</code> / <code>jobs.batch.volcano.sh</code> ç­‰ï¼‰ï¼Œå¹¶ä¸”æ˜¾å¼åˆ—ä¸¾äº† <code>verbs</code>=<code>create|patch|update|delete</code>ã€‚å®ƒä¼šæŠŠ <strong>è¯·æ±‚å¤´ + å“åº”ä½“</strong> å…¨é‡è½ç›˜ï¼Œæ–¹ä¾¿åç»­ Exporter è§£æå‡º <strong>Result (Success/Failure) ä¸å»¶è¿Ÿç›´æ–¹å›¾</strong>ã€‚</li><li><code>Metadata</code> è§„åˆ™çš„ <code>resources: []</code> è¡¨ç¤ºã€Œå…œåº•è§„åˆ™ã€â€”â€”å‡¡æ˜¯ä¸åœ¨å‰ä¸€æ¡å‘½ä¸­åˆ—è¡¨å†…çš„ <strong>ä»»ä½•</strong> èµ„æºï¼Œç»Ÿä¸€åªè®°å½•å…ƒæ•°æ®ï¼ˆè°ã€ä½•æ—¶ã€åšäº†ä»€ä¹ˆï¼‰ï¼Œ<strong>ä¸åŒ…å«è¯·æ±‚/å“åº”ä½“</strong>ã€‚è¿™æ ·æ—¢èƒ½ä¿ç•™å®¡è®¡åˆè§„æ€§ï¼Œåˆé¿å…ä¸ºæµ·é‡æ— å…³å¯¹è±¡å†™å¤§æ–‡ä»¶ã€‚</li></ul></li><li>ä¼˜å…ˆçº§ï¼šKubernetes ä¼šæŒ‰ç…§ YAML ä¸­çš„ <strong>å…ˆåé¡ºåº</strong> åŒ¹é…è§„åˆ™ï¼Œä¸€æ—¦å‘½ä¸­å³åœæ­¢ç»§ç»­åŒ¹é…ã€‚å› æ­¤æœ¬é¡¹ç›®å…ˆå†™ç²¾ç¡®åŒ¹é…ã€å†å†™å…œåº•è§„åˆ™ï¼ŒäºŒè€…ä¸ä¼šå†²çªã€‚</li><li>åŒæ—¶ç¼–å†™ä¸¤æ¡è§„åˆ™çš„ç›®çš„ï¼š<strong>å¹³è¡¡æŒ‡æ ‡ç²¾åº¦ä¸æ—¥å¿—ä½“ç§¯</strong>ã€‚<code>RequestResponse</code> ä¸ºæ ¸å¿ƒå¯¹è±¡æä¾›é«˜ç²’åº¦å»¶è¿Ÿç›´æ–¹å›¾ä¸æˆåŠŸç‡è®¡ç®—ï¼›<code>Metadata</code> å…œåº•æ»¡è¶³å®¡è®¡ç•™ç—•åˆè§„ï¼Œåˆé¿å…ä¸ºæˆç™¾ä¸Šåƒä¸ªä¸è°ƒåº¦æ— å…³çš„å¯¹è±¡å†™å…¥å†—ä½™å“åº”ä½“ï¼Œä»è€Œæ˜¾è‘—é™ä½ç£ç›˜å ç”¨ä¸è§£ææˆæœ¬ã€‚</li></ul><p><strong>â‘¡ ä¸ºä»€ä¹ˆ <code>omitStages</code> è¦æ’é™¤ <code>RequestReceived</code> å’Œ <code>ResponseStarted</code>ï¼Ÿæœ€ç»ˆä¼šè®°å½•å“ªäº› Stageï¼Ÿ</strong></p><ul><li>èƒŒæ™¯ï¼šä¸€æ¬¡ API è¯·æ±‚æœ€å¤šå¯ç”Ÿæˆå››ä¸ª Stage äº‹ä»¶ï¼ˆ<code>RequestReceived</code> â¡ <code>ResponseStarted</code> â¡ <code>ResponseComplete</code> â¡ <code>Panic</code>ï¼‰ã€‚å…¶ä¸­ <code>RequestReceived</code> ä¸ <code>ResponseStarted</code> <em>ä½“é‡å¤§ä¸”ä»·å€¼æœ‰é™</em>ï¼š<ul><li><code>RequestReceived</code> åªè¡¨æ˜ã€Œè¯·æ±‚åˆ°è¾¾äº† APIServerã€ï¼Œä½†æ‹¿ä¸åˆ°ä»»ä½•æ—¶é•¿ä¿¡æ¯ï¼›</li><li><code>ResponseStarted</code> ä»…å¯¹ <strong>é•¿è¿æ¥ watch</strong> åœºæ™¯æ‰ä¼šç”Ÿæˆï¼Œå¯¹æˆ‘ä»¬çš„æ‰¹é‡ CRUD æµ‹è¯•ç”¨ä¾‹å‡ ä¹æ’ä¸ºç©ºï¼›</li></ul></li><li>å› æ­¤åœ¨ç­–ç•¥é‡ŒæŠŠè¿™ä¸¤é˜¶æ®µæ’é™¤ï¼Œæ—¢å‡å°‘æ—¥å¿—ä½“ç§¯ï¼Œä¹Ÿé¿å… Exporter åšæ— æ„ä¹‰è§£æã€‚</li><li>ä¸è§„åˆ™æ— å†²çªï¼š<code>omitStages</code> ä½œç”¨äº <strong>å…¨å±€</strong>ï¼Œå‘Šè¯‰ APIServer åœ¨ç”Ÿæˆå®¡è®¡äº‹ä»¶æ—¶å¿½ç•¥æŒ‡å®šé˜¶æ®µï¼›åé¢çš„ <code>rules</code> åªå†³å®šã€Œå¯¹å“ªäº›è¯·æ±‚ç”Ÿæˆäº‹ä»¶ä»¥åŠç”Ÿæˆåˆ°ä»€ä¹ˆ levelã€ã€‚äºŒè€…å·¥ä½œç»´åº¦ä¸åŒï¼Œä¸ä¼šäº’ç›¸è¦†ç›–ã€‚</li><li>åœ¨æœ¬é¡¹ç›®çš„æ‰¹é‡ Job / Pod æµ‹è¯•ä¸­ï¼Œæœ€ç»ˆå®é™…è½ç›˜çš„ Stage ä¸»è¦æ˜¯ï¼š<ul><li><code>ResponseComplete</code> â€” ç»å¤§å¤šæ•°æ­£å¸¸è¯·æ±‚ï¼›</li><li><code>Panic</code> â€” åªæœ‰å½“ APIServer panic æ‰ä¼šå‡ºç°ï¼ˆç†è®ºä¸Šæå°‘ï¼‰ã€‚</li></ul></li><li>å¦‚ä½•æ‹¿åˆ°ã€Œåˆ›å»º / è°ƒåº¦ / è¿è¡Œã€ç­‰å…³é”®æ—¶é—´ç‚¹ï¼ŸExporter ä»…éœ€å…³æ³¨ <code>stage="ResponseComplete"</code> çš„äº‹ä»¶ï¼š<ul><li><strong>åˆ›å»ºæ—¶é—´</strong>ï¼šåŒ¹é… <code>verb=create</code> ä¸” <code>resource=pods|jobs</code> çš„å®Œæˆæ—¶é—´æˆ³ï¼›</li><li><strong>è°ƒåº¦æ—¶é—´</strong>ï¼šåŒ¹é… <code>resource=pods/binding</code> çš„å®Œæˆæ—¶é—´æˆ³ï¼ˆkube-scheduler å‘ APIServer å‘èµ· bind è¯·æ±‚ï¼‰ï¼›</li><li><strong>è¿è¡Œæ—¶é—´</strong>ï¼šåŒ¹é… <code>resource=pods/status</code>ã€<code>verb=update</code> ä¸” <code>status.phase=Running</code> çš„å®Œæˆæ—¶é—´æˆ³ï¼›<br>Exporter åœ¨å†…å­˜ä¸­ä»¥åŒå Pod UID å…³è”å¤šæ¡äº‹ä»¶ï¼Œè®¡ç®—æ—¶é—´å·®å³å¯ï¼Œæ— éœ€ <code>RequestReceived/Started</code> é˜¶æ®µå³å¯è¿˜åŸå®Œæ•´é“¾è·¯ã€‚</li><li><strong><code>Panic</code> å«ä¹‰</strong>ï¼šå½“ APIServer åœ¨å¤„ç†è¯·æ±‚è¿‡ç¨‹ä¸­å‘ç”Ÿè¿è¡Œæ—¶å´©æºƒå¹¶æ•è·åˆ° panic æ—¶æ‰ä¼šç”Ÿæˆï¼Œç”¨äºäº‹åé—®é¢˜æ’æŸ¥ï¼Œæ­£å¸¸æµ‹è¯•æµç¨‹æç½•è§ã€‚</li></ul></li></ul><p><strong>â‘¢ <code>audit-policy.yaml</code> æ˜¯å¦‚ä½•äº¤ç»™ Kind ä¸­çš„ kube-apiserver çš„ï¼Ÿ</strong></p><ul><li>æ¯ä¸ªè°ƒåº¦å™¨å¯¹åº”çš„ Kind é›†ç¾¤ï¼ˆä½äº <code>clusters/&lt;scheduler&gt;/kind.yaml</code>ï¼‰éƒ½åšäº†å¦‚ä¸‹ä¸‰ç§æ“ä½œï¼š<ol><li><code>extraMounts</code> æŠŠæ ¹ç›®å½•ä¸‹çš„ <code>audit-policy.yaml</code> <strong>æŒ‚è½½</strong>åˆ°æ§åˆ¶å¹³é¢èŠ‚ç‚¹çš„ <code>/etc/kubernetes/policies/audit-policy.yaml</code>ï¼›</li><li><code>apiServer.extraVolumes</code> å®šä¹‰åä¸º <code>audit-policies</code> çš„ HostPath å·ï¼Œå¹¶å°†å…¶æŒ‚è½½åˆ°åŒä¸€è·¯å¾„ï¼Œç¡®ä¿æ–‡ä»¶åœ¨ Pod å†…å¯è¯»ï¼›</li><li><code>apiServer.extraArgs</code> å¢åŠ <div class="code-container" data-rel="Yaml"><figure class="iseeu highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">audit-policy-file:</span> <span class="string">/etc/kubernetes/policies/audit-policy.yaml</span></span><br><span class="line"><span class="attr">audit-log-path:</span> <span class="string">/var/log/kubernetes/kube-apiserver-audit.&lt;scheduler&gt;.log</span></span><br><span class="line"><span class="attr">audit-log-maxsize:</span> <span class="string">"10240"</span></span><br></pre></td></tr></table></figure></div>è¿™æ · APIServer ä¸€å¯åŠ¨å°±æŒ‰ç…§æˆ‘ä»¬è‡ªå®šä¹‰çš„ç­–ç•¥æŠŠå®¡è®¡äº‹ä»¶å†™å…¥å®¿ä¸»æœº <code>/var/log/kubernetes/</code>ï¼Œåç»­å†è¢« Exporter Tailã€‚</li></ol></li></ul><hr><h1 id="2ï¸âƒ£-Exporterï¼škube-apiserver-audit-exporter-æŠŠæ—¥å¿—å˜æˆæŒ‡æ ‡"><a href="#2ï¸âƒ£-Exporterï¼škube-apiserver-audit-exporter-æŠŠæ—¥å¿—å˜æˆæŒ‡æ ‡" class="headerlink" title="2ï¸âƒ£ Exporterï¼škube-apiserver-audit-exporter æŠŠæ—¥å¿—å˜æˆæŒ‡æ ‡"></a>2ï¸âƒ£ Exporterï¼škube-apiserver-audit-exporter æŠŠæ—¥å¿—å˜æˆæŒ‡æ ‡</h1><p>å‰æ–‡ Policy å†³å®šäº†ã€Œè®°å½•ä»€ä¹ˆã€ï¼ŒExporter åˆ™å†³å®šäº†ã€Œæ€ä¹ˆæç‚¼æŒ‡æ ‡ã€ã€‚<br>éƒ¨ç½²æ¸…å•ä½äºï¼š<code>base/kube-apiserver-audit-exporter/kube-apiserver-audit-exporter/deployment.yaml</code></p><div class="code-container" data-rel="Yaml"><figure class="iseeu highlight yaml"><figcaption><span>base/kube-apiserver-audit-exporter/kube-apiserver-audit-exporter/deployment.yaml:24:41</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">...</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">args:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">--audit-log-path</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">/var/log/kubernetes/kube-apiserver-audit.log</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">kind-registry:5000/ghcr.io/wzshiming/kube-apiserver-audit-exporter/kube-apiserver-audit-exporter:v0.0.25</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">exporter</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8080</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">http</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">resources:</span></span><br><span class="line">          <span class="attr">requests:</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">100m</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">100Mi</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/log/kubernetes</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">audit-logs</span></span><br><span class="line"><span class="string">...</span></span><br></pre></td></tr></table></figure></div><p>å…³é”®å‚æ•°è¯´æ˜ï¼š</p><table><thead><tr><th>å­—æ®µ</th><th>å«ä¹‰</th><th>ç¤ºä¾‹å€¼</th></tr></thead><tbody><tr><td><code>--audit-log-path</code></td><td>å®¡è®¡æ—¥å¿—æ‰€åœ¨å®¿ä¸»æœºè·¯å¾„</td><td><code>/var/log/kubernetes/kube-apiserver-audit.log</code></td></tr><tr><td><code>image</code></td><td>å¯ç‹¬ç«‹å‡çº§çš„ Exporter é•œåƒ</td><td><code>â€¦/kube-apiserver-audit-exporter:v0.0.25</code></td></tr><tr><td>VolumeMount</td><td>å°†å®¿ä¸»æœºæ—¥å¿—ç›®å½•æŒ‚è½½è¿› Pod</td><td><code>mountPath: /var/log/kubernetes</code></td></tr></tbody></table><h2 id="ğŸ“Œ-ç»„ä»¶ä½•æ—¶è¢«éƒ¨ç½²ï¼Ÿâ€”â€”-Makefile-è§¦å‘ç‚¹"><a href="#ğŸ“Œ-ç»„ä»¶ä½•æ—¶è¢«éƒ¨ç½²ï¼Ÿâ€”â€”-Makefile-è§¦å‘ç‚¹" class="headerlink" title="ğŸ“Œ ç»„ä»¶ä½•æ—¶è¢«éƒ¨ç½²ï¼Ÿâ€”â€” Makefile è§¦å‘ç‚¹"></a>ğŸ“Œ ç»„ä»¶ä½•æ—¶è¢«éƒ¨ç½²ï¼Ÿâ€”â€” Makefile è§¦å‘ç‚¹</h2><p>åœ¨æœ¬ä»“åº“æœ€å¸¸ç”¨çš„å…¥å£ <code>make default</code> ä¼šè¿ç»­æ‰§è¡Œå¤šè½® <strong>serial-test</strong>ã€‚ç†è§£ä¸€æ¬¡ <em>serial-test</em> çš„æ‰§è¡Œåºåˆ—å³å¯æ˜ç™½ç›‘æ§ç»„ä»¶çš„çœŸå®éƒ¨ç½²æ—¶æœºï¼š</p><table><thead><tr><th>æ­¥éª¤</th><th>è§¦å‘ç›®æ ‡</th><th>å…³é”®åŠ¨ä½œ</th></tr></thead><tbody><tr><td>1</td><td><code>prepare-&lt;scheduler&gt;</code></td><td><code>make up-&lt;scheduler&gt;</code> åˆ›å»º <strong>å•ä¸ªè°ƒåº¦å™¨é›†ç¾¤</strong>ï¼Œä½†æ­¤æ—¶ <em>æ²¡æœ‰</em> ç›‘æ§æ ˆ</td></tr><tr><td>2</td><td><code>start-&lt;scheduler&gt;</code></td><td>è¿è¡Œæ€§èƒ½æµ‹è¯• (<code>TestBatchJob</code> ç­‰) å¹¶ <strong>å†™å…¥ audit-log</strong></td></tr><tr><td>3</td><td><code>end-&lt;scheduler&gt;</code></td><td><code>make down-&lt;scheduler&gt;</code> é”€æ¯è¯¥é›†ç¾¤ï¼Œ<strong>æ—¥å¿—ä»ç•™åœ¨å®¿ä¸»æœº</strong> <code>/var/log/kubernetes/</code></td></tr><tr><td>â¬‡(å¾ªç¯)</td><td>(ä¾æ¬¡æ¢ä¸‹ä¸€ä¸ªè°ƒåº¦å™¨)</td><td>â€¦</td></tr><tr><td>4</td><td><code>prepare-overview</code></td><td><code>make up-overview</code> åˆ›å»º <strong>ç‹¬ç«‹çš„ overview é›†ç¾¤</strong></td></tr><tr><td>5</td><td><code>start-overview</code></td><td><code>clusters/overview/Makefile:start-export</code> éƒ¨ç½² Exporter + PromStackï¼Œå¹¶æŠŠ <em>æ‰€æœ‰</em> <code>kube-apiserver-audit.*.log</code> HostPath æŒ‚è½½åˆ° Pod</td></tr><tr><td>6</td><td><code>save-result</code></td><td>ç¡ <code>$(RESULT_RECENT_DURATION_SECONDS)</code> ç§’ç­‰å¾…æŒ‡æ ‡å°±ç»ªâ†’æ‰§è¡Œ <code>hack/save-result-images.sh</code> æˆªå›¾</td></tr><tr><td>7</td><td><code>end-overview</code></td><td>é”€æ¯ overview é›†ç¾¤ï¼Œèšåˆå¾ªç¯ç»“æŸ</td></tr></tbody></table><blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼š<strong>ExportÂ­er å’Œ Prometheus ç›´åˆ° <em>æ‰€æœ‰</em> è°ƒåº¦å™¨æµ‹è¯•è·‘å®Œåæ‰è¢«ä¸€æ¬¡æ€§æ‹‰èµ·</strong>ï¼Œéšåä¸€æ¬¡æ€§é‡æ”¾/è§£æå…ˆå‰ç•™ä¸‹çš„å¤šä»½ audit-logã€‚</p></blockquote><p>Exporter ä¼š tail æ–‡ä»¶å¹¶å®æ—¶è§£æï¼Œè¾“å‡ºå¦‚ä¸‹ä¸¤ç±» Prometheus æŒ‡æ ‡ï¼ˆç®€åŒ–ï¼‰ï¼š</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># HELP kube_audit_event_total Total number of audit events</span><br><span class="line"># TYPE kube_audit_event_total counter</span><br><span class="line">kube_audit_event_total{verb="create",resource="pods",status="Success"}  1280</span><br><span class="line"></span><br><span class="line"># HELP kube_audit_event_latency_seconds Histogram of audit event latency</span><br><span class="line"># TYPE kube_audit_event_latency_seconds histogram</span><br><span class="line">kube_audit_event_latency_seconds_bucket{resource="pods",le="0.1"} 240</span><br></pre></td></tr></table></figure></div><p>å…¶ä¸­ <code>status="Success"</code> å­—æ®µè®©æˆ‘ä»¬èƒ½å¤Ÿåœ¨ Grafana ä¸­åˆ†åˆ«ç»˜åˆ¶ <strong>CREATED / SCHEDULED / RUNNING</strong> ä¸‰æ¡æ›²çº¿ã€‚</p><h2 id="ğŸ”-å†…éƒ¨å®ç°ï¼šExporter-å¦‚ä½•-tail-è§£æï¼Ÿ"><a href="#ğŸ”-å†…éƒ¨å®ç°ï¼šExporter-å¦‚ä½•-tail-è§£æï¼Ÿ" class="headerlink" title="ğŸ” å†…éƒ¨å®ç°ï¼šExporter å¦‚ä½• tail + è§£æï¼Ÿ"></a>ğŸ” å†…éƒ¨å®ç°ï¼šExporter å¦‚ä½• tail + è§£æï¼Ÿ</h2><p>è¯¥éƒ¨åˆ†æ¯”è¾ƒå¤æ‚ï¼Œæ¶‰åŠå¦ä¸€ä¸ªé¡¹ç›®ã€‚ç®€å•ç†è§£åï¼Œå°†è¯¥éƒ¨åˆ†åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š</p><ul><li><strong>è·Ÿè¸ªæ–‡ä»¶</strong>ï¼šExporter ä½¿ç”¨ Go è¯­è¨€å®ç°ï¼Œå…¥å£ä½äº &lt;base/kube-apiserver-audit-exporter&gt;ï¼Œæºä»“åº“ä½äº<a class="link" target="_blank" rel="noopener" href="https://github.com/wzshiming/kube-apiserver-audit-exporter">https://github.com/wzshiming/kube-apiserver-audit-exporter<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>ã€‚å…¶æ ¸å¿ƒä¾èµ– <code>tail</code>ï¼ˆæˆ– OS <code>inotify</code>ï¼‰æŒç»­è¯»å–å®¿ä¸»æœº <code>/var/log/kubernetes/â€¦audit.log</code>ï¼›</li><li><strong>JSON è§£æ</strong>ï¼šæ¯è¡Œå®¡è®¡æ—¥å¿—éƒ½æ˜¯åˆæ³• JSONï¼ŒExporter åˆ©ç”¨ <code>encoding/json</code> ååºåˆ—åŒ–ä¸º <code>auditinternal.Event</code> ç»“æ„ä½“ï¼ŒéšåæŒ‰ <code>verb / resource / stage / status</code> ç»´åº¦è¿›è¡Œ <code>map</code> èšåˆï¼›</li><li><strong>æŒ‡æ ‡æš´éœ²</strong>ï¼šèšåˆç»“æœé€šè¿‡ <code>prometheus/client_golang</code> è½¬ä¸º <code>counter</code> ä¸ <code>histogram</code> ä¸¤ç±» <code>kube_audit_*</code> æŒ‡æ ‡ï¼›</li></ul><p>è‹¥è¦<strong>å¢åŠ æ›´å¤šæŒ‡æ ‡</strong>ï¼ˆå¦‚è‡ªå®šä¹‰ labelã€å¢åŠ  <code>summary</code> ç­‰ï¼‰ï¼š</p><ul><li><strong>å®šä½ä»£ç </strong>ï¼šä»“åº“ä¸­è·¯å¾„ <code>exporter/metrics.go</code> ä¸‹å¯è§ï¼šä»¥apiRequests(api_requests_total)ã€podSchedulingLatency(pod_scheduling_latency_seconds)ä¸ºä¾‹<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Metric definitions</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">  registry = prometheus.NewRegistry()</span><br><span class="line"></span><br><span class="line">  apiRequests = prometheus.NewCounterVec(prometheus.CounterOpts{</span><br><span class="line">    Name: <span class="string">"api_requests_total"</span>,</span><br><span class="line">    Help: <span class="string">"Total number of API requests to the scheduler"</span>,</span><br><span class="line">  }, []<span class="type">string</span>{<span class="string">"cluster"</span>, <span class="string">"namespace"</span>, <span class="string">"user"</span>, <span class="string">"verb"</span>, <span class="string">"resource"</span>, <span class="string">"code"</span>})</span><br><span class="line">  <span class="comment">// æ ¸å¿ƒä¸ºï¼šapiRequests = prometheus.NewCounterVec(...)</span></span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">  podSchedulingLatency = prometheus.NewHistogramVec(prometheus.HistogramOpts{</span><br><span class="line">    Name:    <span class="string">"pod_scheduling_latency_seconds"</span>,</span><br><span class="line">    Help:    <span class="string">"Duration from pod creation to scheduled on node in seconds"</span>,</span><br><span class="line">    Buckets: prometheus.ExponentialBuckets(<span class="number">0.001</span>, <span class="number">2</span>, <span class="number">20</span>),</span><br><span class="line">  }, []<span class="type">string</span>{<span class="string">"cluster"</span>, <span class="string">"namespace"</span>, <span class="string">"user"</span>})</span><br><span class="line">  <span class="comment">// æ ¸å¿ƒä¸ºï¼šbatchJobCompleteLatency = prometheus.NewCounterVec(...)</span></span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> {</span><br><span class="line">  registry.MustRegister(</span><br><span class="line">    apiRequests,</span><br><span class="line">    podSchedulingLatency,</span><br><span class="line">    ...</span><br><span class="line">  )</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">// updateMetrics processes audit event and updates metrics</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Exporter)</span></span> updateMetrics(clusterLabel <span class="type">string</span>, event auditv1.Event) {</span><br><span class="line">  <span class="comment">// ... æ ¹æ®éœ€æ±‚ï¼Œè‡ªå®šä¹‰è§„åˆ™å°†  verb/resource å¡«å……æŒ‡æ ‡ ...</span></span><br><span class="line">  <span class="keyword">if</span> event.Stage == auditv1.StageResponseComplete {</span><br><span class="line">    labels := []<span class="type">string</span>{</span><br><span class="line">      clusterLabel,</span><br><span class="line">      ns,</span><br><span class="line">      extractUserAgent(event.UserAgent),</span><br><span class="line">      event.Verb,</span><br><span class="line">      extractResourceName(event),</span><br><span class="line">      strconv.Itoa(<span class="type">int</span>(event.ResponseStatus.Code)),</span><br><span class="line">  }</span><br><span class="line">  apiRequests.WithLabelValues(labels...).Inc()</span><br><span class="line">  <span class="comment">// æ ¸å¿ƒä¸ºï¼šapiRequests.WithLabelValues(labels...).Inc()</span></span><br><span class="line"> }</span><br><span class="line">  ...</span><br><span class="line">  <span class="keyword">if</span> event.ObjectRef != <span class="literal">nil</span> {</span><br><span class="line">    <span class="keyword">switch</span> event.ObjectRef.Resource {</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"pods"</span>:</span><br><span class="line">      <span class="keyword">if</span> event.ObjectRef.Subresource == <span class="string">"binding"</span> &amp;&amp; event.Verb == <span class="string">"create"</span> {</span><br><span class="line">        target := buildTarget(event.ObjectRef)</span><br><span class="line">        createTime, exists := p.podCreationTimes[target]</span><br><span class="line">        <span class="keyword">if</span> !exists {</span><br><span class="line">          <span class="comment">// Kueue's audit events may create pod/binding events before pod creation events</span></span><br><span class="line">          user := extractUserAgent(event.UserAgent)</span><br><span class="line">          podSchedulingLatency.WithLabelValues(</span><br><span class="line">            clusterLabel,</span><br><span class="line">            ns,</span><br><span class="line">            user,</span><br><span class="line">          ).Observe(<span class="number">0</span>)</span><br><span class="line">        <span class="comment">// æ ¸å¿ƒä¸ºï¼špodSchedulingLatency.WithLabelValues(...).Observe()</span></span><br><span class="line">          p.podCreationTimes[target] = <span class="literal">nil</span></span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> createTime == <span class="literal">nil</span> {</span><br><span class="line">          <span class="keyword">return</span></span><br><span class="line">        }</span><br><span class="line">        latency := event.StageTimestamp.Sub(*createTime).Seconds()</span><br><span class="line"></span><br><span class="line">        user := extractUserAgent(event.UserAgent)</span><br><span class="line">        podSchedulingLatency.WithLabelValues(</span><br><span class="line">          clusterLabel,</span><br><span class="line">          ns,</span><br><span class="line">          user,</span><br><span class="line">        ).Observe(latency)</span><br><span class="line">      <span class="comment">// æ ¸å¿ƒä¸ºï¼špodSchedulingLatency.WithLabelValues(...).Observe()</span></span><br><span class="line">        p.podCreationTimes[target] = <span class="literal">nil</span></span><br><span class="line"></span><br><span class="line">      }</span><br><span class="line">      ...</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div></li><li><strong>æ‰©å±•æ­¥éª¤</strong>ï¼š<ol><li>å¤åˆ¶ï¼šå¤åˆ¶ä¸Šè¿°å˜é‡å—ï¼Œæ›¿æ¢ <code>Name</code> ä¸º <code>kube_audit_pod_latency_seconds</code>ï¼ˆç¤ºä¾‹ï¼‰ï¼ŒåŒæ—¶è°ƒæ•´ <code>Buckets</code>ã€<code>Help</code> ç­‰å‚æ•°ï¼›</li><li>ä¿®æ”¹ï¼šåœ¨ <code>updateMetrics</code> ä¸­å¢åŠ æ¡ä»¶ï¼š<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> evt.ObjectRef.Resource == <span class="string">"pods"</span> {</span><br><span class="line">    podLatency.WithLabelValues(evt.Verb, evt.Stage).Observe(cost)</span><br><span class="line">}</span><br></pre></td></tr></table></figure></div></li><li>æ³¨å†Œï¼šç¡®ä¿åœ¨ <code>init()</code> æˆ– <code>NewCollector()</code> ä¸­ <code>registry.MustRegister(podLatency)</code>ï¼›</li><li>æ¢é•œåƒï¼š<code>docker build -t &lt;registry&gt;/audit-exporter:dev . &amp;&amp; docker push â€¦</code>ï¼Œç„¶ååœ¨ <code>base/kube-apiserver-audit-exporter/.../deployment.yaml</code> æ›´æ–° <code>image</code> å¹¶ <code>kubectl apply -k</code>ã€‚</li></ol></li></ul><blockquote><p>å®Œæ•´ç¤ºä¾‹å¯å‚è€ƒé¡¹ç›® <code>exporter/metrics.go</code> <a class="link" target="_blank" rel="noopener" href="https://github.com/wzshiming/kube-apiserver-audit-exporter/blob/master/exporter/metrics.go">æºç <i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>ã€‚</p></blockquote><hr><h1 id="3ï¸âƒ£-Prometheus-æŠ“å–ï¼šKustomize-ä¸€æ¡é¾™"><a href="#3ï¸âƒ£-Prometheus-æŠ“å–ï¼šKustomize-ä¸€æ¡é¾™" class="headerlink" title="3ï¸âƒ£ Prometheus æŠ“å–ï¼šKustomize ä¸€æ¡é¾™"></a>3ï¸âƒ£ Prometheus æŠ“å–ï¼šKustomize ä¸€æ¡é¾™</h1><p><code>base/kube-prometheus-stack</code> ç›®å½•é€šè¿‡ Kustomize æŠŠ Exporterã€Prometheus Operator ä¸å¤šä¸ª ServiceMonitor ç»„åˆåœ¨ä¸€èµ·ï¼Œæ— éœ€é¢å¤–æ‰‹åŠ¨é…ç½®æŠ“å–ç›®æ ‡ã€‚</p><ul><li>Prometheus ä¼šè‡ªåŠ¨å‘ç° Exporter çš„ <code>metrics</code> ç«¯å£ï¼›</li><li>Grafana é¢æ¿ JSON <code>audit-exporter.json</code> å·²é¢„ç½®åœ¨åŒç›®å½•ï¼Œæ ‡ç­¾åˆ‡ç‰‡ï¼ˆScheduler ç±»å‹ã€Namespaceã€Verbï¼‰å‡å¯åŠ¨æ€é€‰æ‹©ã€‚</li></ul><blockquote><p>è‹¥è¦è‡ªå®šä¹‰é˜ˆå€¼æˆ–é¢œè‰²ï¼Œåªéœ€ <code>kubectl edit cm grafana-dashboards</code> ååˆ·æ–°æµè§ˆå™¨å³å¯å³æ—¶ç”Ÿæ•ˆã€‚</p></blockquote><p>å…¶ä¸­ç”¨åˆ°äº† Kustomize å·¥å…·ï¼Œè¾ƒä¸ºå¤æ‚ï¼Œåœ¨æ­¤ä»…ç®€å•ä»‹ç»ã€‚</p><h2 id="âœ¨-Kustomize-ç®€ä»‹"><a href="#âœ¨-Kustomize-ç®€ä»‹" class="headerlink" title="âœ¨ Kustomize ç®€ä»‹"></a>âœ¨ Kustomize ç®€ä»‹</h2><p>Kustomize æ˜¯ Kubernetes å®˜æ–¹æä¾›çš„ <strong>åŸç”Ÿèµ„æºå®šåˆ¶å·¥å…·</strong>ï¼Œæ ¸å¿ƒç†å¿µæ˜¯â€œå£°æ˜å¼ Patch ä¸ç»„åˆâ€ã€‚ç›¸æ¯” <code>helm</code>ï¼Œå®ƒæ— éœ€æ¨¡æ¿è¯­è¨€ï¼Œä¹Ÿä¸å¼•å…¥é¢å¤– CRDï¼š</p><ul><li><strong>åŸºç¡€èµ„æº</strong>ï¼ˆBaseï¼‰ï¼šæ¯ä¸ªç›®å½•ä¸‹çš„ <code>kustomization.yaml</code> åˆ—å‡ºè‹¥å¹² <code>resources</code>ï¼Œå¯æŒ‰æ–‡ä»¶æˆ–ç›®å½•å¼•ç”¨ï¼›</li><li><strong>å åŠ å±‚</strong>ï¼ˆOverlayï¼‰ï¼šä¸Šå±‚å¯ä»¥é€šè¿‡ <code>patches</code>, <code>images</code>, <code>replicas</code> ç­‰å£°æ˜å¼å­—æ®µè¦†å†™æˆ–è¿½åŠ é…ç½®ï¼›</li><li><strong>ç”Ÿæˆå™¨</strong>ï¼š<code>configMapGenerator</code>, <code>secretGenerator</code> å¿«é€Ÿä¸ºåº”ç”¨ç”Ÿæˆå¼•ç”¨ã€‚</li></ul><p>åœ¨æœ¬é¡¹ç›®ä¸­ï¼š</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">base/kube-prometheus-stack/           # ç›‘æ§åŸºç¡€ç»„ä»¶ Base</span><br><span class="line">  â”œâ”€â”€ crd/                            # CRD èµ„æº</span><br><span class="line">  â”œâ”€â”€ grafana/                        # Dashboard JSON åŠè´¦å·</span><br><span class="line">  â”œâ”€â”€ ...</span><br><span class="line">  â””â”€â”€ kustomization.yaml              # å£°æ˜æ‰€æœ‰ç»„ä»¶</span><br></pre></td></tr></table></figure></div><p><code>clusters/overview/Makefile</code> é‡Œçš„ <code>kubectl kustomize &lt;dir&gt; | hack/local-registry-with-load-images.sh</code> ä¸¤æ­¥åšäº†ï¼š</p><ol><li><code>kubectl kustomize</code> â†’ <strong>æ¸²æŸ“</strong>ï¼šæŠŠä»¥ä¸Š Base + Patch è§£ææˆçº¯ YAML æ¸…å•ï¼›</li><li><code>local-registry-with-load-images.sh</code> â†’ <strong>é•œåƒå¤„ç†</strong>ï¼šé‡å†™é¡åƒåœ°å€åˆ°æœ¬åœ° Kind Registry å¹¶é¢„å…ˆ <code>docker pull</code>ï¼›</li><li><code>kubectl create -k</code> â†’ <strong>åº”ç”¨</strong>ï¼šæ‰¹é‡åˆ›å»º Exporterã€Prometheus Operatorã€Alertmanagerã€ServiceMonitor ç­‰æ‰€æœ‰èµ„æºï¼Œä¸€æ¬¡åˆ°ä½ã€‚</li></ol><p>å› æ­¤æˆ‘ä»¬æ‰èƒ½â€œä¸€é”® makeâ€æ‹¿åˆ°å®Œæ•´çš„ç›‘æ§æ ˆã€‚</p><hr><h1 id="4ï¸âƒ£-æˆªå›¾å½’æ¡£ï¼šsave-result-images-sh-å½’æ¡£é¢æ¿æˆªå›¾"><a href="#4ï¸âƒ£-æˆªå›¾å½’æ¡£ï¼šsave-result-images-sh-å½’æ¡£é¢æ¿æˆªå›¾" class="headerlink" title="4ï¸âƒ£ æˆªå›¾å½’æ¡£ï¼šsave-result-images.sh å½’æ¡£é¢æ¿æˆªå›¾"></a>4ï¸âƒ£ æˆªå›¾å½’æ¡£ï¼šsave-result-images.sh å½’æ¡£é¢æ¿æˆªå›¾</h1><p>è¿è¡Œ <code>make save-result</code> åï¼Œ<code>hack/save-result-images.sh</code> ä¼šåœ¨æœ¬åœ°å¾ªç¯è°ƒç”¨ Grafana <code>render</code> APIï¼ŒæŒ‰é¢æ¿ ID ç”Ÿæˆ <code>output/panel-*.png</code>ï¼š</p><div class="code-container" data-rel="Sh"><figure class="iseeu highlight sh"><figcaption><span>hack/save-result-images.sh</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">RECENT_DURATION=<span class="variable">${RECENT_DURATION:-5min}</span></span><br><span class="line"></span><br><span class="line">FROM=$(<span class="built_in">date</span> -u -Iseconds -d <span class="string">"- <span class="variable">${RECENT_DURATION}</span>"</span> | sed <span class="string">'s/+00:00/.000Z/'</span>)</span><br><span class="line">TO=$(<span class="built_in">date</span> -u -Iseconds | sed <span class="string">'s/+00:00/.000Z/'</span>)</span><br><span class="line"></span><br><span class="line">OUTPUT=<span class="string">"<span class="variable">${ROOT_DIR}</span>/output"</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="string">"<span class="variable">${OUTPUT}</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> {1..8}; <span class="keyword">do</span></span><br><span class="line">  wget -O <span class="string">"<span class="variable">${OUTPUT}</span>/panel-<span class="variable">${i}</span>.png"</span> <span class="string">"http://127.0.0.1:8080/grafana/render/d-solo/perf?var-rate_interval=5s&amp;orgId=1&amp;from=<span class="variable">${FROM}</span>&amp;to=<span class="variable">${TO}</span>&amp;timezone=browser&amp;var-datasource=prometheus&amp;var-resource=\$__all&amp;var-user=\$__all&amp;var-verb=create&amp;var-verb=delete&amp;var-verb=patch&amp;var-verb=update&amp;var-namespace=default&amp;var-cluster=\$__all&amp;refresh=5s&amp;theme=dark&amp;panelId=panel-<span class="variable">${i}</span>&amp;__feature.dashboardSceneSolo&amp;width=900&amp;height=500&amp;scale=10"</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure></div><ul><li><code>RECENT_DURATION</code> ç¯å¢ƒå˜é‡æ§åˆ¶ <em>æˆªå›¾æ—¶é—´çª—å£</em>ï¼ˆé»˜è®¤ 5 åˆ†é’Ÿï¼‰ï¼›</li><li><code>FROM/TO</code> æ—¶é—´æˆ³ä½¿ç”¨ ISO-8601 UTC æ¯«ç§’æ ¼å¼ï¼Œé¿å…æ—¶åŒºæ··æ·†ï¼›</li><li><code>panelId</code> ä¸é¢æ¿ JSON ä¸­çš„ <code>id</code> ä¸€ä¸€å¯¹åº”ï¼Œå¯æ ¹æ®éœ€è¦æ‰©å±•ã€‚</li></ul><p>ç¤ºä¾‹è¾“å‡ºç›®å½•ç»“æ„ï¼š</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">output/</span><br><span class="line">  â”œâ”€â”€ panel-1.png   # CREATED é€Ÿç‡</span><br><span class="line">  â”œâ”€â”€ panel-2.png   # SCHEDULED é€Ÿç‡</span><br><span class="line">  â”œâ”€â”€ panel-3.png   # RUNNING é€Ÿç‡</span><br><span class="line">  â””â”€â”€ â€¦</span><br></pre></td></tr></table></figure></div><h2 id="â±ï¸-ä¸ºä»€ä¹ˆä¸‰å¥—è°ƒåº¦å™¨æ›²çº¿å¯¹é½åˆ°åŒä¸€èµ·å§‹æ—¶é—´ï¼Ÿ"><a href="#â±ï¸-ä¸ºä»€ä¹ˆä¸‰å¥—è°ƒåº¦å™¨æ›²çº¿å¯¹é½åˆ°åŒä¸€èµ·å§‹æ—¶é—´ï¼Ÿ" class="headerlink" title="â±ï¸ ä¸ºä»€ä¹ˆä¸‰å¥—è°ƒåº¦å™¨æ›²çº¿å¯¹é½åˆ°åŒä¸€èµ·å§‹æ—¶é—´ï¼Ÿ"></a>â±ï¸ ä¸ºä»€ä¹ˆä¸‰å¥—è°ƒåº¦å™¨æ›²çº¿å¯¹é½åˆ°åŒä¸€èµ·å§‹æ—¶é—´ï¼Ÿ</h2><p>åœ¨ <em>serial-test</em> æ¨¡å¼ä¸‹ï¼ŒExporter ç›´åˆ°ç¬¬ 4 æ­¥æ‰å¯åŠ¨ï¼Œ<strong>å®ƒä¼šä»å¤´å¼€å§‹é¡ºåºæ‰«ææ‰€æœ‰ audit-log</strong>ã€‚Prometheus é‡‡é›†æ—¶å°†ã€Œç¬¬ä¸€æ¬¡ scrape è¯¥æŒ‡æ ‡çš„æ—¶åˆ»ã€è§†ä¸ºæ ·æœ¬æ—¶é—´æˆ³ï¼Œè€Œä¸æ˜¯äº‹ä»¶å‘ç”Ÿæ—¶é—´ã€‚å› æ­¤ï¼š</p><ul><li>å½“ Exporter ç¬¬ä¸€æ¬¡è¯»å– <em>ä¸‰ä»½</em> æ—¥å¿—æ–‡ä»¶æ—¶ï¼ˆçº¦ <strong>T0</strong>ï¼‰ï¼Œæ‰€æœ‰æŒ‡æ ‡éƒ½ä¼šå¸¦ä¸Š <strong>T0</strong> çš„ç»Ÿä¸€æ—¶é—´æˆ³ï¼›</li><li>è¯»å–å®Œç¬¬ä¸€ä»½æ–‡ä»¶åç»§ç»­ç¬¬äºŒã€ç¬¬ä¸‰ä»½â€”â€”å¯¹äº Prometheus æ¥è¯´ä¹Ÿä»æ˜¯ â€œT0~T0+Î”â€ çš„æ—¶é—´çª—å£ï¼›</li></ul><p>ç»“æœå°±æ˜¯ï¼šGrafana å›¾ä¸Šä¸‰æ¡æ›²çº¿ä¼¼ä¹â€œåŒä¸€æ—¶åˆ»èµ·è·‘â€ã€‚å®ƒä»¬å¹¶éå¹¶å‘ï¼Œè€Œæ˜¯ <strong>æ—¥å¿—å›æ”¾é€ æˆçš„æ—¶é—´æŠ˜å </strong> â€”â€” å…ˆè·‘çš„è°ƒåº¦å™¨å…¶å®æ›´æ—©å®Œæˆï¼Œä½†å…¶äº‹ä»¶è¢«å»¶åæ‰è¢«é‡‡é›†ã€‚</p><p>å¦‚æœå¸Œæœ›æ›²çº¿æŒ‰çœŸå®äº‹ä»¶æ—¶é—´å±•å¼€ï¼Œå¯ä»¥ï¼š</p><ol><li>ä¿®æ”¹ Exporterï¼Œè®©å®ƒæŠŠ <code>evt.StageTimestamp</code> ç”¨ä½œ Prometheus <code>histogram</code> çš„ <code>ObserveWithTimestamp</code>ï¼›</li><li>æˆ–è€…åœ¨æµ‹è¯•æµç¨‹ä¸­æå‰å¯åŠ¨ overview é›†ç¾¤ï¼Œä½¿ Exporter æŒ‰å®æ—¶æ¨¡å¼æŒç»­é‡‡é›†ã€‚</li></ol><p>å¦‚æœæƒ³<strong>äº²çœ¼æŸ¥çœ‹ audit-log</strong>ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼š</p><ol><li><strong>ç›´æ¥è¯»å®¿ä¸»æœºæ–‡ä»¶</strong>ï¼ˆKind èŠ‚ç‚¹å®é™…ä¸Šæ˜¯ Docker å®¹å™¨ï¼‰ï¼š<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> kueue-control-plane \</span><br><span class="line">  <span class="built_in">cat</span> /var/log/kubernetes/kube-apiserver-audit.kueue.log | <span class="built_in">head</span></span><br></pre></td></tr></table></figure></div>ä¸‰ä¸ªæ–‡ä»¶åç§°åˆ†åˆ«ä¸º <code>kube-apiserver-audit.{kueue|volcano|yunikorn}.log</code>ã€‚</li><li><strong>æŸ¥çœ‹ Exporter å®¹å™¨æ—¥å¿—</strong>ï¼ˆoverview é›†ç¾¤ï¼‰ï¼š<div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n monitoring logs deploy/kube-apiserver-audit-exporter | <span class="built_in">head</span></span><br></pre></td></tr></table></figure></div>å¯åŠ¨æ—¶å®ƒä¼šæ‰“å° <code>starting from offset=0 file=...</code>ï¼Œè¡¨æ˜æ­£åœ¨ä»å¤´é‡æ”¾ã€‚</li></ol><blockquote><p>æ—¥å¿—æ–‡ä»¶å¾ˆå¤§ï¼Œå¯ç”¨ <code>grep '"verb":"create"'</code> ç­‰å‘½ä»¤è¿‡æ»¤æ„Ÿå…´è¶£äº‹ä»¶ï¼Œå­—æ®µå«ä¹‰è¯¦è§ Kubernetes å®˜æ–¹å®¡è®¡æ–‡æ¡£ã€‚</p></blockquote><h2 id="ğŸ“Š-Panel-ä¸€è§ˆé€ŸæŸ¥è¡¨"><a href="#ğŸ“Š-Panel-ä¸€è§ˆé€ŸæŸ¥è¡¨" class="headerlink" title="ğŸ“Š Panel ä¸€è§ˆé€ŸæŸ¥è¡¨"></a>ğŸ“Š Panel ä¸€è§ˆé€ŸæŸ¥è¡¨</h2><table><thead><tr><th>é¢æ¿ ID</th><th>Grafana æ ‡é¢˜</th><th>è¾“å‡ºæ–‡ä»¶</th><th>ä¸»è¦æŸ¥è¯¢</th><th>å…¸å‹ç”¨é€”</th></tr></thead><tbody><tr><td>panel-1</td><td>Pod Scheduling Latency Group By UserAgent</td><td>panel-1.png</td><td><code>histogram_quantile(0.99, pod_scheduling_latency_seconds_bucket)</code> ç­‰åˆ†ä½çº¿</td><td>è°ƒåº¦å»¶è¿Ÿé•¿å°¾ç›‘æ§</td></tr><tr><td>panel-2</td><td>Total API Calls Group By (UserAgent, Verb, Resource)</td><td>panel-2.png</td><td><code>api_requests_total</code> ç´¯ç§¯</td><td>å…¨ç»´åº¦ API è°ƒç”¨è®¡æ•°</td></tr><tr><td>panel-3</td><td>API Calls Rate Group By (UserAgent, Verb, Resource)</td><td>panel-3.png</td><td><code>rate(api_requests_total[$rate_interval])</code></td><td>API ååè¶‹åŠ¿ï¼ˆå«èµ„æº/åŠ¨è¯ç»´åº¦ï¼‰</td></tr><tr><td>panel-4</td><td>BatchJob Completion Latency Group By UserAgent</td><td>panel-4.png</td><td><code>histogram_quantile(... batchjob_completion_latency_seconds_bucket)</code></td><td>å…³æ³¨ Job å®Œæˆå»¶è¿Ÿ</td></tr><tr><td>panel-5</td><td>Total Pod Scheduled Group By UserAgent</td><td>panel-5.png</td><td><code>sum(pod_scheduling_latency_seconds_count)</code> vs <code>sum(api_requests_total{verb="create",resource="pods"})</code></td><td>å¯¹æ¯”å·²è°ƒåº¦ä¸å·²åˆ›å»º Pod æ€»é‡</td></tr><tr><td>panel-6</td><td>Total BatchJob Completed Group By UserAgent</td><td>panel-6.png</td><td><code>sum(batchjob_completion_latency_seconds_count)</code></td><td>Job å®Œæˆæ€»é‡ç»Ÿè®¡</td></tr><tr><td>panel-7</td><td>Total API Calls Group By UserAgent</td><td>panel-7.png</td><td><code>sum(api_requests_total) by (cluster,user)</code></td><td>æŒ‰ UserAgent ç»´åº¦ç´¯è®¡ API è°ƒç”¨</td></tr><tr><td>panel-8</td><td>API Calls Rate Group By UserAgent</td><td>panel-8.png</td><td><code>rate(api_requests_total[$rate_interval])</code></td><td>æŒ‰ UserAgent ç»´åº¦ API åå</td></tr></tbody></table><blockquote><p>ä»¥ä¸Šæ‰€æœ‰æŸ¥è¯¢çš†å¯åœ¨ <code>base/kube-prometheus-stack/audit-exporter.json</code> ä¸­æ‰¾åˆ°å¯¹åº” <code>panel.id</code> çš„ <code>expr</code> å­—æ®µã€‚</p></blockquote><h3 id="ğŸ·ï¸-CREATED-SCHEDULED-æŒ‡æ ‡ä¸-Panel-5-è§£è¯»"><a href="#ğŸ·ï¸-CREATED-SCHEDULED-æŒ‡æ ‡ä¸-Panel-5-è§£è¯»" class="headerlink" title="ğŸ·ï¸ CREATED / SCHEDULED æŒ‡æ ‡ä¸ Panel-5 è§£è¯»"></a>ğŸ·ï¸ CREATED / SCHEDULED æŒ‡æ ‡ä¸ Panel-5 è§£è¯»</h3><p>Grafana çš„ <strong>panel-5.png</strong>ï¼ˆ<code>Total Pod Scheduled Group By UserAgent</code>ï¼‰åŒæ—¶å åŠ äº† <em>ç´¯è®¡å·²è°ƒåº¦</em> ä¸ <em>ç´¯è®¡å·²åˆ›å»º</em> ä¸¤æ¡æ—¶é—´åºåˆ—ï¼Œç”¨æ¥å¿«é€Ÿåˆ¤æ–­â€œè°ƒåº¦å™¨ååé‡æ˜¯å¦è·Ÿå¾—ä¸Šå·¥ä½œè´Ÿè½½äº§ç”Ÿé€Ÿåº¦â€ã€‚</p><p>ä¸¤æ¡åºåˆ—çš„ PromQL å¦‚ä¸‹ï¼š</p><div class="code-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># å·²è°ƒåº¦æ€»é‡ï¼ˆSeries-Aï¼‰</span><br><span class="line">sum(pod_scheduling_latency_seconds_count{cluster=~"$cluster",namespace=~"$namespace",user=~"$user"}) by (cluster,user)</span><br><span class="line"></span><br><span class="line"># å·²åˆ›å»ºæ€»é‡ï¼ˆSeries-Bï¼‰</span><br><span class="line">sum(api_requests_total{cluster=~"$cluster",namespace=~"$namespace",user=~"$user",resource="pods",verb="create"}) by (cluster,user)</span><br></pre></td></tr></table></figure></div><blockquote><p>ğŸ’¡ <strong>èµ„æºç±»å‹</strong></p><ul><li>ä¸¤æ¡åºåˆ—å‡é’ˆå¯¹ <strong>Pod</strong> èµ„æºï¼š<ul><li><strong>Series-Bï¼ˆCREATEDï¼‰</strong> æ•è· <code>verb=create, resource=pods</code> çš„å®¡è®¡äº‹ä»¶ï¼›</li><li><strong>Series-Aï¼ˆSCHEDULEDï¼‰</strong> ç»Ÿè®¡ <code>pod_scheduling_latency_seconds_count</code> ç›´æ–¹å›¾è®¡æ•°ï¼ŒåŒæ ·åŸºäº Pod UID èšåˆã€‚</li></ul></li><li>Volcano ä¸­çš„ <strong>PodGroup</strong> ä»…åœ¨ <em>Gang</em> åœºæ™¯ä¸‹è¾…åŠ©è°ƒåº¦ï¼Œä¸ä¼šå‡ºç°åœ¨ä¸Šè¿°æŒ‡æ ‡ä¸­ï¼Œå› å…¶åˆ›å»ºé¢‘æ¬¡è¿œä½äº Podï¼Œä¸”éè°ƒåº¦å™¨ååä¸»ç“¶é¢ˆã€‚</li></ul></blockquote><h3 id="â„¹ï¸-ä¸ºä»€ä¹ˆ-Panel-5-é‡‡ç”¨-pod-scheduling-latency-seconds-countï¼Ÿå¯ä»¥æ”¹ç”¨-api-requests-total-å—ï¼Ÿ"><a href="#â„¹ï¸-ä¸ºä»€ä¹ˆ-Panel-5-é‡‡ç”¨-pod-scheduling-latency-seconds-countï¼Ÿå¯ä»¥æ”¹ç”¨-api-requests-total-å—ï¼Ÿ" class="headerlink" title="â„¹ï¸ ä¸ºä»€ä¹ˆ Panel-5 é‡‡ç”¨ pod_scheduling_latency_seconds_countï¼Ÿå¯ä»¥æ”¹ç”¨ api_requests_total å—ï¼Ÿ"></a>â„¹ï¸ ä¸ºä»€ä¹ˆ Panel-5 é‡‡ç”¨ <code>pod_scheduling_latency_seconds_count</code>ï¼Ÿå¯ä»¥æ”¹ç”¨ <code>api_requests_total</code> å—ï¼Ÿ</h3><ol><li><strong>æ•°æ®æºå·®å¼‚</strong><ul><li><code>api_requests_total{verb="create",resource="pods/binding"}</code> ä¹Ÿèƒ½åæ˜ è°ƒåº¦åŠ¨ä½œï¼Œä½† <strong>Exporter é»˜è®¤å¹¶æœªå°† <code>pods/binding</code> äº‹ä»¶æ‰“å…¥æ­¤ Counter</strong>ï¼Œè€Œæ˜¯äº¤ç”± <code>pod_scheduling_latency_seconds</code> Histogram ç»Ÿä¸€å¤„ç†ï¼ˆå…·ä½“å®ç°å¯è§æœ¬æ–‡â€œ<a href="#-%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0exporter-%E5%A6%82%E4%BD%95-tail--%E8%A7%A3%E6%9E%90">ğŸ” å†…éƒ¨å®ç°ï¼šExporter å¦‚ä½• tail + è§£æï¼Ÿ</a>â€ç« èŠ‚ä»£ç ç¤ºä¾‹ï¼‰ï¼Œä»¥ä¾¿åŒæ—¶ç»Ÿè®¡ç´¯ç§¯å»¶è¿Ÿã€‚</li><li>Histogram è‡ªå¸¦ <code>_count</code> ç³»åˆ—ï¼Œå¤©ç„¶è¡¨ç¤º <strong>æˆåŠŸè°ƒåº¦æ¬¡æ•°</strong>ï¼›å…¶ Bucket ä»èƒ½è®¡ç®— P99 ç­‰å»¶è¿Ÿ â€”â€” ä¸€ä¸¾ä¸¤å¾—ã€‚</li></ul></li><li><strong>ç»Ÿè®¡ç²¾åº¦</strong><ul><li>Exporter å¯¹åŒä¸€ Pod ä»…åœ¨ <strong>é¦–æ¬¡ç»‘å®šæˆåŠŸ</strong> æ—¶ <code>Observe</code> ä¸€æ¬¡ï¼Œæ‰€ä»¥ <code>_count</code> ä¸å®é™…è°ƒåº¦ Pod æ•°é‡ä¸€ä¸€å¯¹åº”ï¼Œä¸ä¼šå¤šè®¡ã€‚</li><li>è‹¥ç›´æ¥ä½¿ç”¨ <code>api_requests_total</code> æ–¹æ¡ˆï¼Œéœ€è¦ç¡®ä¿ï¼š<ol><li>Exporter ä¹ŸæŠŠ <code>pods/binding</code> è®¡å…¥ Counterï¼›</li><li>Retry æˆ–å¤±è´¥é‡è¯•åœºæ™¯ä¼šå¯¼è‡´å¤šè®¡ï¼Œéœ€è¦é¢å¤– <code>status="Success"</code> è¿‡æ»¤ã€‚</li></ol></li></ul></li><li><strong>æ›¿ä»£æ–¹æ¡ˆ</strong><ul><li>è‹¥ä½ æ›´ä¹ æƒ¯ Counterï¼Œå¯åœ¨ <code>metrics.go</code> ä¸­è¿½åŠ ï¼š<div class="code-container" data-rel="Go"><figure class="iseeu highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">podBindRequests := prometheus.NewCounterVec(... name=<span class="string">"pod_bind_requests_total"</span> ...)</span><br><span class="line"><span class="comment">// åœ¨ event.ObjectRef.Subresource=="binding" æ—¶ Inc()</span></span><br></pre></td></tr></table></figure></div></li><li>ç„¶ååœ¨ Dashboard å°† Panel-5 çš„ Series-A æ”¹ä¸º <code>sum(pod_bind_requests_total)</code>ã€‚</li></ul></li></ol><p>âš–ï¸ <strong>ç»“è®º</strong>ï¼šé»˜è®¤ <code>_count</code> ä¸ Counter æ•ˆæœä¸€è‡´ä¸”æ— éœ€æ–°æŒ‡æ ‡ï¼Œ<strong>ä¸ä¼šå¯¼è‡´è°ƒåº¦æ•°é‡è¯¯å·®</strong>ï¼›è‹¥éœ€è¦å¯æ ¹æ®ä¸Šè¿°æ–¹æ³•è‡ªå®šä¹‰ã€‚</p><hr><h1 id="5ï¸âƒ£-æœ¬åœ°éªŒè¯ï¼šä¸‰æ­¥èµ°"><a href="#5ï¸âƒ£-æœ¬åœ°éªŒè¯ï¼šä¸‰æ­¥èµ°" class="headerlink" title="5ï¸âƒ£ æœ¬åœ°éªŒè¯ï¼šä¸‰æ­¥èµ°"></a>5ï¸âƒ£ æœ¬åœ°éªŒè¯ï¼šä¸‰æ­¥èµ°</h1><ol><li><strong>æœ€å°è§„æ¨¡è·‘ä¸€æ¬¡</strong></li></ol><div class="code-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">make prepare-volcano start-volcano end-volcano \</span><br><span class="line">    NODES_SIZE=1 JOBS_SIZE_PER_QUEUE=1 PODS_SIZE_PER_JOB=1</span><br></pre></td></tr></table></figure></div><ol start="2"><li><strong>æ‰“å¼€ Grafana</strong></li></ol><p>æµè§ˆå™¨è®¿é—® <a class="link" target="_blank" rel="noopener" href="http://127.0.0.1:8080/grafana">http://127.0.0.1:8080/grafana<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>ï¼ŒDashboards â†’ <code>perf</code>ï¼Œå³å¯çœ‹åˆ°å®æ—¶æ›²çº¿ã€‚</p><ol start="3"><li><strong>æŸ¥çœ‹æˆªå›¾</strong></li></ol><p>æµ‹è¯•ç»“æŸåï¼Œ<code>output/</code> å°†å‡ºç°è‡ªåŠ¨æˆªå¥½çš„å›¾ç‰‡ï¼Œç¡®è®¤æ—¶é—´è½´ä¸æ›²çº¿ä¸€è‡´ã€‚</p><hr><hr><ul><li>å¸Œæœ›è¿™ç¯‡åšå®¢å¯¹ä½ æœ‰å¸®åŠ©ï¼å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·éšæ—¶æé—®ã€‚</li><li>å¦‚æœä½ å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Œæ¬¢è¿<a class="link" target="_blank" rel="noopener" href="https://github.com/freshwlnd/">åŠ¨åŠ¨å°æ‰‹<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a>ç»™æˆ‘ä¸€ä¸ªfollowæˆ–starã€‚</li></ul><h1 id="x1f5fa-å‚è€ƒæ–‡çŒ®"><a href="#x1f5fa-å‚è€ƒæ–‡çŒ®" class="headerlink" title="ğŸ—ºå‚è€ƒæ–‡çŒ®"></a><span class="emoji" alias="world_map" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f5fa.png?v8">ğŸ—º</span>å‚è€ƒæ–‡çŒ®</h1><div id="refer-anchor-1"></div><p><a class="link" target="_blank" rel="noopener" href="https://github.com/wzshiming/kube-scheduling-perf">[1] Github - kube-scheduling-perf<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p><a class="link" target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=njT5r3JjIaA&list=PLj6h78yzYM2MP0QhYFK8HOb8UqgbIkLMc&index=226">[2] A Comparative Analysis of Kueue, Volcano, and YuniKorn - Wei Huang, Apple &amp; Shiming Zhang, DaoCloud<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p><a class="link" target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/tasks/debug/debug-cluster/audit/">[3] Kuberneteså®˜æ–¹æ–‡æ¡£ - å®¡è®¡<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p><p><a class="link" target="_blank" rel="noopener" href="https://kubernetes.io/zh-cn/docs/reference/config-api/apiserver-audit.v1/#audit-k8s-io-v1-Policy">[4] Kuberneteså®˜æ–¹æ–‡æ¡£ - å®¡è®¡Policyé…ç½®å‚è€ƒ<i class="fa-solid fa-arrow-up-right ml-[0.2em] font-light align-text-top text-[0.7em] link-icon"></i></a></p></div><div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8"><div class="article-copyright-info-container"><ul><li><strong>æ ‡é¢˜:</strong> ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–</li><li><strong>ä½œè€…:</strong> Fre5h1nd</li><li><strong>åˆ›å»ºäº :</strong> 2025-08-07 22:59:25</li><li><strong>æ›´æ–°äº :</strong> 2025-09-18 15:27:36</li><li><strong>é“¾æ¥:</strong> https://freshwlnd.github.io/2025/08/07/k8s/k8s-scheduler-performance-volcano-metrics/</li><li><strong>ç‰ˆæƒå£°æ˜: </strong>æœ¬æ–‡ç« é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> è¿›è¡Œè®¸å¯ã€‚</li></ul></div></div><ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden"><li class="tag-item mx-0.5"><a href="/tags/K8s/">#K8s</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/">#æ€§èƒ½æµ‹è¯•</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/%E7%9B%91%E6%8E%A7/">#ç›‘æ§</a>&nbsp;</li><li class="tag-item mx-0.5"><a href="/tags/Volcano/">#Volcano</a>&nbsp;</li></ul><div class="recommended-article px-2 sm:px-6 md:px-8"><div class="recommended-desktop"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>æ¨èé˜…è¯»</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/2025/09/09/k8s/k8s-scheduler-performance-go-analysis/" title="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ" rel="bookmark"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5hB_X47V-i7AvleaI8BDE-haL1cEn2vHptg&s" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ" class="!max-w-none"> <span class="title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ</span> </a><a class="recommended-article-item" href="/2025/08/10/k8s/k8s-scheduler-performance-volcano-analysis/" title="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜" rel="bookmark"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5hB_X47V-i7AvleaI8BDE-haL1cEn2vHptg&s" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜" class="!max-w-none"> <span class="title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜</span> </a><a class="recommended-article-item" href="/2025/08/08/k8s/k8s-scheduler-performance-volcano-custom/" title="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano è‡ªå®šä¹‰é•œåƒä¸äºŒæ¬¡å‹æµ‹" rel="bookmark"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5hB_X47V-i7AvleaI8BDE-haL1cEn2vHptg&s" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano è‡ªå®šä¹‰é•œåƒä¸äºŒæ¬¡å‹æµ‹" class="!max-w-none"> <span class="title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano è‡ªå®šä¹‰é•œåƒä¸äºŒæ¬¡å‹æµ‹</span></a></div></div><div class="recommended-mobile"><div class="recommended-article-header text-xl md:text-3xl font-bold mt-10"><i aria-hidden="true"></i><span>æ¨èé˜…è¯»</span></div><div class="recommended-article-group"><a class="recommended-article-item" href="/2025/09/09/k8s/k8s-scheduler-performance-go-analysis/" title="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ" rel="bookmark"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5hB_X47V-i7AvleaI8BDE-haL1cEn2vHptg&s" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ" class="!max-w-none"> <span class="title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šGo é¡¹ç›®è§£æä¸å¹¶å‘ç¼–ç¨‹å®è·µ</span> </a><a class="recommended-article-item" href="/2025/08/10/k8s/k8s-scheduler-performance-volcano-analysis/" title="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜" rel="bookmark"><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcT5hB_X47V-i7AvleaI8BDE-haL1cEn2vHptg&s" alt="ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜" class="!max-w-none"> <span class="title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æ•°æ®æ”¶é›†æ–¹æ³•æ·±åº¦è§£æä¸Prometheus Histogramè¯¯å·®é—®é¢˜</span></a></div></div></div><div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8"><div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="prev" rel="prev" href="/2025/08/08/k8s/k8s-scheduler-performance-volcano-custom/"><span class="left arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-left"></i> </span><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano è‡ªå®šä¹‰é•œåƒä¸äºŒæ¬¡å‹æµ‹</span> <span class="post-nav-item">ä¸Šä¸€ç¯‡</span></span></a></div><div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2"><a class="next" rel="next" href="/2025/07/27/k8s/k8s-scheduler-performance-volcano-process/"><span class="title flex justify-center items-center"><span class="post-nav-title-item truncate max-w-48">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æµ‹è¯•æµç¨‹æ‹†è§£</span> <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span> </span><span class="right arrow-icon flex justify-center items-center"><i class="fa-solid fa-chevron-right"></i></span></a></div></div><div class="comment-container px-2 sm:px-6 md:px-8 pb-8"><div class="comments-container mt-10 w-full"><div id="comment-anchor" class="w-full h-2.5"></div><div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">è¯„è®º</div><div id="gitalk-container"></div><script data-swup-reload-script src="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js"></script><script data-swup-reload-script>function loadGitalk(){let e=decodeURI(location.pathname);e.length>50&&(e=e.substring(0,47)+"...");try{Gitalk&&new Gitalk({clientID:"4d4a8706873446558037",clientSecret:"72c9ec35e05bda1ed29e5321f912397811568e0a",repo:"GitalkStorehouse",owner:"Freshwlnd",admin:["Freshwlnd"],id:e,language:"zh-CN",proxy:"https://strong-caramel-969805.netlify.app/github_access_token"}).render("gitalk-container")}catch(e){window.Gitalk=null}}{const e=setTimeout(()=>{loadGitalk(),clearTimeout(e)},1e3)}</script></div></div></div><div class="toc-content-container"><div class="post-toc-wrap"><div class="post-toc"><div class="toc-title">ç›®å½•</div><div class="page-title">ã€é›†ç¾¤ã€‘äº‘åŸç”Ÿæ‰¹è°ƒåº¦å®æˆ˜ï¼šVolcano æŒ‡æ ‡é‡‡é›†ä¸å¯è§†åŒ–</div><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-%E5%AE%A1%E8%AE%A1%E6%97%A5%E5%BF%97%EF%BC%9Aaudit-policy-yaml-%E5%86%B3%E5%AE%9A%E8%AE%B0%E5%BD%95%E4%BB%80%E4%B9%88"><span class="nav-number">1.</span> <span class="nav-text">1ï¸âƒ£ å®¡è®¡æ—¥å¿—ï¼šaudit-policy.yaml å†³å®šè®°å½•ä»€ä¹ˆ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%96%B6%EF%B8%8F-FAQ%EF%BC%9A%E7%AD%96%E7%95%A5%E7%BB%86%E8%8A%82%E5%B8%B8%E8%A7%81%E7%96%91%E9%97%AE"><span class="nav-number">1.1.</span> <span class="nav-text">â–¶ï¸ FAQï¼šç­–ç•¥ç»†èŠ‚å¸¸è§ç–‘é—®</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-Exporter%EF%BC%9Akube-apiserver-audit-exporter-%E6%8A%8A%E6%97%A5%E5%BF%97%E5%8F%98%E6%88%90%E6%8C%87%E6%A0%87"><span class="nav-number">2.</span> <span class="nav-text">2ï¸âƒ£ Exporterï¼škube-apiserver-audit-exporter æŠŠæ—¥å¿—å˜æˆæŒ‡æ ‡</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8C-%E7%BB%84%E4%BB%B6%E4%BD%95%E6%97%B6%E8%A2%AB%E9%83%A8%E7%BD%B2%EF%BC%9F%E2%80%94%E2%80%94-Makefile-%E8%A7%A6%E5%8F%91%E7%82%B9"><span class="nav-number">2.1.</span> <span class="nav-text">ğŸ“Œ ç»„ä»¶ä½•æ—¶è¢«éƒ¨ç½²ï¼Ÿâ€”â€” Makefile è§¦å‘ç‚¹</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%94%8D-%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0%EF%BC%9AExporter-%E5%A6%82%E4%BD%95-tail-%E8%A7%A3%E6%9E%90%EF%BC%9F"><span class="nav-number">2.2.</span> <span class="nav-text">ğŸ” å†…éƒ¨å®ç°ï¼šExporter å¦‚ä½• tail + è§£æï¼Ÿ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-Prometheus-%E6%8A%93%E5%8F%96%EF%BC%9AKustomize-%E4%B8%80%E6%9D%A1%E9%BE%99"><span class="nav-number">3.</span> <span class="nav-text">3ï¸âƒ£ Prometheus æŠ“å–ï¼šKustomize ä¸€æ¡é¾™</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%9C%A8-Kustomize-%E7%AE%80%E4%BB%8B"><span class="nav-number">3.1.</span> <span class="nav-text">âœ¨ Kustomize ç®€ä»‹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4%EF%B8%8F%E2%83%A3-%E6%88%AA%E5%9B%BE%E5%BD%92%E6%A1%A3%EF%BC%9Asave-result-images-sh-%E5%BD%92%E6%A1%A3%E9%9D%A2%E6%9D%BF%E6%88%AA%E5%9B%BE"><span class="nav-number">4.</span> <span class="nav-text">4ï¸âƒ£ æˆªå›¾å½’æ¡£ï¼šsave-result-images.sh å½’æ¡£é¢æ¿æˆªå›¾</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%8F%B1%EF%B8%8F-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%89%E5%A5%97%E8%B0%83%E5%BA%A6%E5%99%A8%E6%9B%B2%E7%BA%BF%E5%AF%B9%E9%BD%90%E5%88%B0%E5%90%8C%E4%B8%80%E8%B5%B7%E5%A7%8B%E6%97%B6%E9%97%B4%EF%BC%9F"><span class="nav-number">4.1.</span> <span class="nav-text">â±ï¸ ä¸ºä»€ä¹ˆä¸‰å¥—è°ƒåº¦å™¨æ›²çº¿å¯¹é½åˆ°åŒä¸€èµ·å§‹æ—¶é—´ï¼Ÿ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%F0%9F%93%8A-Panel-%E4%B8%80%E8%A7%88%E9%80%9F%E6%9F%A5%E8%A1%A8"><span class="nav-number">4.2.</span> <span class="nav-text">ğŸ“Š Panel ä¸€è§ˆé€ŸæŸ¥è¡¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%8F%B7%EF%B8%8F-CREATED-SCHEDULED-%E6%8C%87%E6%A0%87%E4%B8%8E-Panel-5-%E8%A7%A3%E8%AF%BB"><span class="nav-number">4.2.1.</span> <span class="nav-text">ğŸ·ï¸ CREATED &#x2F; SCHEDULED æŒ‡æ ‡ä¸ Panel-5 è§£è¯»</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%84%B9%EF%B8%8F-%E4%B8%BA%E4%BB%80%E4%B9%88-Panel-5-%E9%87%87%E7%94%A8-pod-scheduling-latency-seconds-count%EF%BC%9F%E5%8F%AF%E4%BB%A5%E6%94%B9%E7%94%A8-api-requests-total-%E5%90%97%EF%BC%9F"><span class="nav-number">4.2.2.</span> <span class="nav-text">â„¹ï¸ ä¸ºä»€ä¹ˆ Panel-5 é‡‡ç”¨ pod_scheduling_latency_seconds_countï¼Ÿå¯ä»¥æ”¹ç”¨ api_requests_total å—ï¼Ÿ</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5%EF%B8%8F%E2%83%A3-%E6%9C%AC%E5%9C%B0%E9%AA%8C%E8%AF%81%EF%BC%9A%E4%B8%89%E6%AD%A5%E8%B5%B0"><span class="nav-number">5.</span> <span class="nav-text">5ï¸âƒ£ æœ¬åœ°éªŒè¯ï¼šä¸‰æ­¥èµ°</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#x1f5fa-%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-number">6.</span> <span class="nav-text">ğŸ—ºå‚è€ƒæ–‡çŒ®</span></a></li></ol></div></div></div></div></div></div><div class="main-content-footer"><footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color"><div class="info-container py-3 text-center"><div class="text-center">&copy; <span>2018</span> - 2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration:0.5s;color:#f54545"></i>&nbsp;&nbsp;<a href="/">Fre5h1nd</a><p class="post-count space-x-0.5"><span>å…±æ’°å†™äº† 162 ç¯‡æ–‡ç«  </span><span>å…± 397.7k å­—</span></p></div><script data-swup-reload-script src="https://cn.vercount.one/js"></script><div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right"><span id="busuanzi_container_site_uv" class="lg:!block"><span class="text-sm">è®¿é—®äººæ•°</span> <span id="busuanzi_value_site_uv"></span> </span><span id="busuanzi_container_site_pv" class="lg:!block"><span class="text-sm">æ€»è®¿é—®é‡</span> <span id="busuanzi_value_site_pv"></span></span></div><div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left"><span class="lg:block text-sm">ç”± <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="åœ–å±¤_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> é©±åŠ¨</span> <span class="text-sm lg:block">ä¸»é¢˜&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.5</a></span></div><div>åšå®¢å·²è¿è¡Œ <span class="odometer" id="runtime_days"></span> å¤© <span class="odometer" id="runtime_hours"></span> å°æ—¶ <span class="odometer" id="runtime_minutes"></span> åˆ†é’Ÿ <span class="odometer" id="runtime_seconds"></span> ç§’</div><script data-swup-reload-script>try{function odometer_init(){document.querySelectorAll(".odometer").forEach(e=>{new Odometer({el:e,format:"( ddd).dd",duration:200})})}odometer_init()}catch(e){}</script></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="article-tools-list"><li class="right-bottom-tools page-aside-toggle"><i class="fa-regular fa-outdent"></i></li><li class="go-comment"><i class="fa-regular fa-comments"></i></li></ul></div></div><div class="right-side-tools-container"><div class="side-tools-container"><ul class="hidden-tools-list"><li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-plus"></i></li><li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center"><i class="fa-regular fa-magnifying-glass-minus"></i></li><li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center"><i class="fa-regular fa-moon"></i></li><li class="right-bottom-tools rss flex justify-center items-center"><a class="flex justify-center items-center" href="/atom.xml" target="_blank"><i class="fa-regular fa-rss"></i></a></li><li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center"><i class="fa-regular fa-arrow-down"></i></li></ul><ul class="visible-tools-list"><li class="right-bottom-tools toggle-tools-list flex justify-center items-center"><i class="fa-regular fa-cog fa-spin"></i></li><li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center"><i class="arrow-up fas fa-arrow-up"></i> <span class="percent"></span></li></ul></div></div><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fa-solid fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="ç«™å†…æœç´¢æ‚¨éœ€è¦çš„å†…å®¹..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa-solid fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/Swup.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/SwupSlideTheme.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/SwupScriptsPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/SwupProgressPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/SwupScrollPlugin.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/SwupPreloadPlugin.min.js"></script><script>const swup=new Swup({plugins:[new SwupScriptsPlugin({optin:!0}),new SwupProgressPlugin,new SwupScrollPlugin({offset:80}),new SwupSlideTheme({mainElement:".main-content-body"}),new SwupPreloadPlugin],containers:["#swup"]})</script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/imageViewer.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/utils.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/main.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/layouts/navbarShrink.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/scrollTopBottom.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/lightDarkSwitch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/layouts/categoryList.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/localSearch.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/codeBlock.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/layouts/lazyload.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/runtime.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/odometer.min.js"></script><link rel="stylesheet" href="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/assets/odometer-theme-minimal.css"><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/Typed.min.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/plugins/typed.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/mermaid.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/plugins/mermaid.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/minimasonry.min.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/plugins/masonry.js"></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/tools/tocToggle.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/layouts/toc.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/plugins/tabs.js" data-swup-reload-script></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/moment-with-locales.min.js" data-swup-reload-script></script><script type="module" src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/layouts/essays.js" data-swup-reload-script></script><div id="aplayer"></div><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/libs/APlayer.min.js"></script><script src="https://registry.npmmirror.com/hexo-theme-redefine/2.8.5/files/source/js/build/plugins/aplayer.js"></script></body></html>